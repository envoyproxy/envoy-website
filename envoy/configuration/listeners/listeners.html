

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Listeners &mdash; envoy 1.5.0-cfa8d1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="envoy 1.5.0-cfa8d1 documentation" href="../../index.html"/>
        <link rel="up" title="Configuration reference" href="../configuration.html"/>
        <link rel="next" title="Filters" href="filters.html"/>
        <link rel="prev" title="Runtime" href="../overview/runtime.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                1.5.0-cfa8d1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/install.html">Building and installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Listeners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssl.html">TLS context</a></li>
<li class="toctree-l3"><a class="reference internal" href="stats.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime.html">Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="lds.html">Listener discovery service</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistics">Statistics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../network_filters/network_filters.html">Network filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http_conn_man/http_conn_man.html">HTTP connection manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http_filters/http_filters.html">HTTP filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cluster_manager/cluster_manager.html">Cluster manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/router_check.html">Route table check tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">envoy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../configuration.html">Configuration reference</a> &raquo;</li>
        
      <li>Listeners</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/configuration/listeners/listeners.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="listeners">
<span id="config-listeners"></span><h1>Listeners<a class="headerlink" href="#listeners" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The top level Envoy configuration contains a list of <a class="reference internal" href="../../intro/arch_overview/listeners.html#arch-overview-listeners"><span class="std std-ref">listeners</span></a>.
Each individual listener configuration has the following format:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;ssl_context&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;bind_to_port&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;use_proxy_proto&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;use_original_dst&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_connection_buffer_limit_bytes&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="config-listeners-name">
<dt>name</dt>
<dd><em>(optional, string)</em> The unique name by which this listener is known. If no name is provided,
Envoy will allocate an internal UUID for the listener. If the listener is to be dynamically
updated or removed via <a class="reference internal" href="lds.html#config-listeners-lds"><span class="std std-ref">LDS</span></a> a unique name must be provided.
By default, the maximum length of a listener’s name is limited to 60 characters. This limit can be
increased by setting the <a class="reference internal" href="../../operations/cli.html#cmdoption-max-obj-name-len"><code class="xref std std-option docutils literal"><span class="pre">--max-obj-name-len</span></code></a> command line argument to the desired value.</dd>
<dt>address</dt>
<dd><em>(required, string)</em> The address that the listener should listen on. Currently only TCP
listeners are supported, e.g., “<a class="reference external" href="tcp://127.0.0.1:80">tcp://127.0.0.1:80</a>”. Note, “<a class="reference external" href="tcp://0.0.0.0:80">tcp://0.0.0.0:80</a>” is the wild card
match for any IPv4 address with port 80.</dd>
<dt><a class="reference internal" href="filters.html#config-listener-filters"><span class="std std-ref">filters</span></a></dt>
<dd><p class="first"><em>(required, array)</em> A list of individual <a class="reference internal" href="../../intro/arch_overview/network_filters.html#arch-overview-network-filters"><span class="std std-ref">network filters</span></a>
that make up the filter chain for connections established with the listener. Order matters as the
filters are processed sequentially as connection events happen.</p>
<p class="last"><strong>Note:</strong> If the filter list is empty, the connection will close by default.</p>
</dd>
<dt><a class="reference internal" href="ssl.html#config-listener-ssl-context"><span class="std std-ref">ssl_context</span></a></dt>
<dd><em>(optional, object)</em> The <a class="reference internal" href="../../intro/arch_overview/ssl.html#arch-overview-ssl"><span class="std std-ref">TLS</span></a> context configuration for a TLS listener.
If no TLS context block is defined, the listener is a plain text listener.</dd>
<dt>bind_to_port</dt>
<dd><em>(optional, boolean)</em> Whether the listener should bind to the port. A listener that doesn’t bind
can only receive connections redirected from other listeners that set use_original_dst parameter to
true. Default is true.</dd>
<dt>use_proxy_proto</dt>
<dd><em>(optional, boolean)</em> Whether the listener should expect a
<a class="reference external" href="http://www.haproxy.org/download/1.5/doc/proxy-protocol.txt">PROXY protocol V1</a> header on new
connections. If this option is enabled, the listener will assume that that remote address of the
connection is the one specified in the header. Some load balancers including the AWS ELB support
this option. If the option is absent or set to false, Envoy will use the physical peer address
of the connection as the remote address.</dd>
<dt>use_original_dst</dt>
<dd><em>(optional, boolean)</em> If a connection is redirected using <em>iptables</em>, the port on which the proxy
receives it might be different from the original destination port. When this flag is set to true,
the listener hands off redirected connections to the listener associated with the original
destination port. If there is no listener associated with the original destination port, the
connection is handled by the listener that receives it. Default is false.</dd>
</dl>
<dl class="docutils" id="config-listeners-per-connection-buffer-limit-bytes">
<dt>per_connection_buffer_limit_bytes</dt>
<dd><em>(optional, integer)</em> Soft limit on size of the listener’s new connection read and write buffers.
If unspecified, an implementation defined default is applied (1MiB).</dd>
</dl>
<div class="section" id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h2>
<p>The listener manager has a statistics tree rooted at <em>listener_manager.</em> with the following
statistics. Any <code class="docutils literal"><span class="pre">:</span></code> character in the stats name is replaced with <code class="docutils literal"><span class="pre">_</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>listener_added</td>
<td>Counter</td>
<td>Total listeners added (either via static config or LDS)</td>
</tr>
<tr class="row-odd"><td>listener_modified</td>
<td>Counter</td>
<td>Total listeners modified (via LDS)</td>
</tr>
<tr class="row-even"><td>listener_removed</td>
<td>Counter</td>
<td>Total listeners removed (via LDS)</td>
</tr>
<tr class="row-odd"><td>listener_create_success</td>
<td>Counter</td>
<td>Total listener objects successfully added to workers.</td>
</tr>
<tr class="row-even"><td>listener_create_failure</td>
<td>Counter</td>
<td>Total failed listener object additions to workers.</td>
</tr>
<tr class="row-odd"><td>total_listeners_warming</td>
<td>Gauge</td>
<td>Number of currently warming listeners</td>
</tr>
<tr class="row-even"><td>total_listeners_active</td>
<td>Gauge</td>
<td>Number of currently active listeners</td>
</tr>
<tr class="row-odd"><td>total_listeners_draining</td>
<td>Gauge</td>
<td>Number of currently draining listeners</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="filters.html" class="btn btn-neutral float-right" title="Filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../overview/runtime.html" class="btn btn-neutral" title="Runtime" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, Lyft.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.5.0-cfa8d1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>