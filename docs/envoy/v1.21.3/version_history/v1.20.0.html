<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.20.0 (October 5, 2021) &mdash; envoy tag-v1.21.3 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/envoy.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.19.1 (Aug 24, 2021)" href="v1.19.1.html" />
    <link rel="prev" title="1.20.1 (November 30, 2021)" href="v1.20.1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                tag-v1.21.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/overview.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="version_history.html">Version history</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="current.html">1.21.3 (June 9, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.2.html">1.21.2 (April 27, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.1.html">1.21.1 (February 22, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.0.html">1.21.0 (January 12, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.1.html">1.20.1 (November 30, 2021)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.20.0 (October 5, 2021)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#incompatible-behavior-changes">Incompatible Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minor-behavior-changes">Minor Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removed-config-or-runtime">Removed Config or Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deprecated">Deprecated</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.1.html">1.19.1 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.0.html">1.19.0 (July 13, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.4.html">1.18.4 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.3.html">1.18.3 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.2.html">1.18.2 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.1.html">1.18.1 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.0.html">1.18.0 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.4.html">1.17.4 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.3.html">1.17.3 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.2.html">1.17.2 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.1.html">1.17.1 (February 25, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.0.html">1.17.0 (January 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.5.html">1.16.5 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.4.html">1.16.4 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.3.html">1.16.3 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.2.html">1.16.2 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.1.html">1.16.1 (November 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.0.html">1.16.0 (October 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.5.html">1.15.5 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.4.html">1.15.4 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.3.html">1.15.3 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.2.html">1.15.2 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.1.html">1.15.1 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.0.html">1.15.0 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.7.html">1.14.7 (April 15, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.6.html">1.14.6 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.5.html">1.14.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.4.html">1.14.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.3.html">1.14.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.2.html">1.14.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.1.html">1.14.1 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.0.html">1.14.0 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.8.html">1.13.8 (January 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.7.html">1.13.7 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.6.html">1.13.6 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.5.html">1.13.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.4.html">1.13.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.3.html">1.13.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.2.html">1.13.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.1.html">1.13.1 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.0.html">1.13.0 (January 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.7.html">1.12.7 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.6.html">1.12.6 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.5.html">1.12.5 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.4.html">1.12.4 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.3.html">1.12.3 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.2.html">1.12.2 (December 10, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.1.html">1.12.1 (November 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.0.html">1.12.0 (October 31, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.2.html">1.11.2 (October 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.1.html">1.11.1 (August 13, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.0.html">1.11.0 (July 11, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.10.0.html">1.10.0 (Apr 5, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.1.html">1.9.1 (Apr 2, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.0.html">1.9.0 (Dec 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.8.0.html">1.8.0 (Oct 4, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.7.0.html">1.7.0 (Jun 21, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.6.0.html">1.6.0 (March 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.5.0.html">1.5.0 (December 4, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.4.0.html">1.4.0 (August 24, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.3.0.html">1.3.0 (May 17, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.2.0.html">1.2.0 (March 7, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.1.0.html">1.1.0 (November 30, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.0.0.html">1.0.0 (September 12, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#deprecation-policy">Deprecation Policy</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="version_history.html">Version history</a> &raquo;</li>
      <li>1.20.0 (October 5, 2021)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/version_history/v1.20.0.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="october-5-2021">
<h1>1.20.0 (October 5, 2021)<a class="headerlink" href="#october-5-2021" title="Permalink to this headline">¶</a></h1>
<div class="section" id="incompatible-behavior-changes">
<h2>Incompatible Behavior Changes<a class="headerlink" href="#incompatible-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required</em></p>
<ul class="simple">
<li><p>config: due to the switch to using work-in-progress annotations and warnings to indicate APIs
subject to change, the following API packages have been force migrated from <code class="docutils literal notranslate"><span class="pre">v3alpha</span></code> to <code class="docutils literal notranslate"><span class="pre">v3</span></code>:
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.access_loggers.open_telemetry.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.cache.simple_http_cache.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.admission_control.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.bandwidth_limit.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.cache.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.cdn_loop.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.ext_proc.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.http.oauth2.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.network.sni_dynamic_forward_proxy.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.filters.udp.dns_filter.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.transport_sockets.s2a.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.extensions.watchdog.profile_action.v3</span></code>,
<code class="docutils literal notranslate"><span class="pre">envoy.service.ext_proc.v3</span></code>, and
<code class="docutils literal notranslate"><span class="pre">envoy.watchdog.v3</span></code>. If your production deployment was using one of these APIs, you will be
forced to potentially vendor the old proto file to continue serving old versions of Envoy.
The project realizes this is unfortunate because some of these are known to be used in production,
however the project does not have the resources to undergo a migration in which we support
<code class="docutils literal notranslate"><span class="pre">v3alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">v3</span></code> at the same time. The switch to using work-in-progress annotations with
clear and explicit warnings will avoid any such issue in the future. We apologize again for any
difficulty this change causes, though it is for the best. Additionally, some of the above
namespaces have had their work-in-progress annotations removed due to known production usage.
Thus, they will not warn and are offered full API stability support by the project from this
point forward.</p></li>
<li><p>config: the <code class="docutils literal notranslate"><span class="pre">--bootstrap-version</span></code> CLI flag has been removed, Envoy has only been able to accept v3
bootstrap configurations since 1.18.0.</p></li>
<li><p>contrib: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/http/http_filters/squash_filter.html#config-http-filters-squash" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">squash filter</span></a> has been moved to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>.</p></li>
<li><p>contrib: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/listeners/network_filters/kafka_broker_filter.html#config-network-filters-kafka-broker" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">kafka broker filter</span></a> has been moved to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>.</p></li>
<li><p>contrib: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/listeners/network_filters/rocketmq_proxy_filter.html#config-network-filters-rocketmq-proxy" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">RocketMQ proxy filter</span></a> has been moved to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>.</p></li>
<li><p>contrib: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/listeners/network_filters/postgres_proxy_filter.html#config-network-filters-postgres-proxy" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">Postgres proxy filter</span></a> has been moved to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>.</p></li>
<li><p>contrib: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/listeners/network_filters/mysql_proxy_filter.html#config-network-filters-mysql-proxy" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">MySQL proxy filter</span></a> has been moved to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>.</p></li>
<li><p>dns_filter: <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/udp/dns_filter/v3/dns_filter.proto.html#envoy-v3-api-msg-extensions-filters-udp-dns-filter-v3-dnsfilterconfig" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">dns_filter</span></a>
protobuf fields have been renumbered to restore compatibility with Envoy
1.18, breaking compatibility with Envoy 1.19.0 and 1.19.1. The new field
numbering allows control planes supporting Envoy 1.18 to gracefully upgrade to
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/udp/dns_filter/v3/dns_filter.proto.html#envoy-v3-api-field-extensions-filters-udp-dns-filter-v3-dnsfilterconfig-clientcontextconfig-dns-resolution-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">dns_resolution_config</span></a>,
provided they skip over Envoy 1.19.0 and 1.19.1.
Control planes upgrading from Envoy 1.19.0 and 1.19.1 will need to
vendor the corresponding protobuf definitions to ensure that the
renumbered fields have the types expected by those releases.</p></li>
<li><p>extensions: deprecated extension names now default to triggering a configuration error.
The previous warning-only behavior may be temporarily reverted by setting the runtime key
<code class="docutils literal notranslate"><span class="pre">envoy.deprecated_features.allow_deprecated_extension_names</span></code> to true.</p></li>
</ul>
</div>
<div class="section" id="minor-behavior-changes">
<h2>Minor Behavior Changes<a class="headerlink" href="#minor-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that may cause incompatibilities for some users, but should not for most</em></p>
<ul class="simple">
<li><p>client_ssl_auth filter: now sets additional termination details and <code class="docutils literal notranslate"><span class="pre">UAEX</span></code> response flag when the client certificate is not in the allowed-list.</p></li>
<li><p>config: configuration files ending in .yml now load as YAML.</p></li>
<li><p>config: configuration file extensions now ignore case when deciding the file type. E.g., .JSON files load as JSON.</p></li>
<li><p>config: reduced log level for “Unable to establish new stream” xDS logs to debug. The log level
for “gRPC config stream closed” is now reduced to debug when the status is <code class="docutils literal notranslate"><span class="pre">Ok</span></code> or has been
retriable (<code class="docutils literal notranslate"><span class="pre">DeadlineExceeded</span></code>, <code class="docutils literal notranslate"><span class="pre">ResourceExhausted</span></code>, or <code class="docutils literal notranslate"><span class="pre">Unavailable</span></code>) for less than 30
seconds.</p></li>
<li><p>config: use of work-in-progress API files, messages, or fields will now generate an explicit
warning. Please read the text about <code class="docutils literal notranslate"><span class="pre">(xds.annotations.v3.file_status).work_in_progress</span></code>,
<code class="docutils literal notranslate"><span class="pre">(xds.annotations.v3.message_status).work_in_progress</span></code>, and
<code class="docutils literal notranslate"><span class="pre">(xds.annotations.v3.field_status).work_in_progress</span></code>
<a class="reference external" href="https://github.com/envoyproxy/envoy/blob/main/api/STYLE.md">here</a> for more information. Some
APIs that are known to be implicitly not work-in-progress have been force migrated and are
individually indicated elsewhere in the release notes. A server-wide <code class="docutils literal notranslate"><span class="pre">wip_protos</span></code> counter has
also been added in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/observability/statistics.html#server-statistics" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">server statistics</span></a> to track this.</p></li>
<li><p>ext_authz: fixed skipping authentication when returning either a direct response or a redirect. This behavior can be temporarily reverted by setting the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_ext_authz_do_not_skip_direct_response_and_redirect</span></code> runtime guard to false.</p></li>
<li><p>grpc: gRPC async client can be cached and shared across filter instances in the same thread, this feature is turned off by default, can be turned on by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.enable_grpc_async_client_cache</span></code> to true.</p></li>
<li><p>http: correct the use of the <code class="docutils literal notranslate"><span class="pre">x-forwarded-proto</span></code> header and the <code class="docutils literal notranslate"><span class="pre">:scheme</span></code> header. Where they differ
(which is rare) <code class="docutils literal notranslate"><span class="pre">:scheme</span></code> will now be used for serving redirect URIs and cached content. This behavior
can be reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">correct_scheme_and_xfp</span></code> to false.</p></li>
<li><p>http: reject requests with #fragment in the URI path. The fragment is not allowed to be part of the request
URI according to RFC3986 (3.5), RFC7230 (5.1) and RFC 7540 (8.1.2.3). Rejection of requests can be changed
to stripping the #fragment instead by setting the runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_reject_path_with_fragment</span></code>
to false. This behavior can further be changed to the deprecated behavior of keeping the fragment by setting the runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_strip_fragment_from_path_unsafe_if_disabled</span></code>. This runtime guard must only be set
to false when existing non-compliant traffic relies on #fragment in URI. When this option is enabled, Envoy request
authorization extensions may be bypassed. This override and its associated behavior will be decommissioned after the standard deprecation period.</p></li>
<li><p>http: set the default <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/intro/arch_overview/http/http_connection_management.html#arch-overview-http-header-map-settings" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">lazy headermap threshold</span></a> to 3,
which defines the minimal number of headers in a request/response/trailers required for using a
dictionary in addition to the list. Setting the <code class="docutils literal notranslate"><span class="pre">envoy.http.headermap.lazy_map_min_size</span></code> runtime
feature to a non-negative number will override the default value.</p></li>
<li><p>http: stop processing pending H/2 frames if connection transitioned to a closed state. This behavior can be temporarily reverted by setting the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.skip_dispatching_frames_for_closed_connection</span></code> to false.</p></li>
<li><p>listener: added the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-enable-reuse-port" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">enable_reuse_port</span></a>
field and changed the default for <code class="docutils literal notranslate"><span class="pre">reuse_port</span></code> from false to true, as the feature is now well
supported on the majority of production Linux kernels in use. The default change is aware of the hot
restart, as otherwise, the change would not be backward compatible between restarts. This means
that hot restarting onto a new binary will retain the default of false until the binary undergoes
a full restart. To retain the previous behavior, either explicitly set the new configuration
field to false, or set the runtime feature flag <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.listener_reuse_port_default_enabled</span></code>
to false. As part of this change, the use of <code class="docutils literal notranslate"><span class="pre">reuse_port</span></code> for TCP listeners on both macOS and
Windows has been disabled due to suboptimal behavior. See the field documentation for more
information.</p></li>
<li><p>listener: destroy per network filter chain stats when a network filter chain is removed during the listener in-place update.</p></li>
<li><p>quic: enables IETF connection migration. This feature requires a stable UDP packet routine in the L4 load balancer with the same first-4-bytes in connection id. It can be turned off by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.FLAGS_quic_reloadable_flag_quic_connection_migration_use_new_cid_v2</span></code> to false.</p></li>
<li><p>thrift_proxy: allow Framed and Header transport combinations to perform <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/network/thrift_proxy/v3/thrift_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-thrift-proxy-v3-thriftproxy-payload-passthrough" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">payload passthrough</span></a>.</p></li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h2>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes expected to improve the state of the world and are unlikely to have negative effects</em></p>
<ul class="simple">
<li><p>access log: fix <code class="docutils literal notranslate"><span class="pre">%UPSTREAM_CLUSTER%</span></code> when used in http upstream access logs. Previously, it was always logging as an unset value.</p></li>
<li><p>aws request signer: fix the AWS Request Signer extension to correctly normalize the path and query string to be signed according to AWS’ guidelines, so that the hash on the server side matches. See <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html">AWS SigV4 documentation</a>.</p></li>
<li><p>cluster: delete pools when they’re idle to fix unbounded memory use when using PROXY protocol upstream with tcp_proxy. This behavior can be temporarily reverted by setting the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.conn_pool_delete_when_idle</span></code> runtime guard to false.</p></li>
<li><p>cluster: finish cluster warming even if hosts are removed before health check initialization. This only affected clusters with <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-ignore-health-on-host-removal" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">ignore_health_on_host_removal</span></a>.</p></li>
<li><p>compressor: fix a bug where if trailers were added and a subsequent filter paused the filter chain, the request could be stalled. This behavior can be reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.fix_added_trailers</span></code> to false.</p></li>
<li><p>dynamic forward proxy: fixing a validation bug where san and sni checks were not applied setting <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/upstreams/http/v3/http_protocol_options.proto.html#envoy-v3-api-msg-extensions-upstreams-http-v3-httpprotocoloptions" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">http_protocol_options</span></a> via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-typed-extension-protocol-options" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">typed_extension_protocol_options</span></a>.</p></li>
<li><p>ext_authz: fix the ext_authz filter to correctly merge multiple same headers using the ‘,’ as separator in the check request to the external authorization service.</p></li>
<li><p>ext_authz: fix the use of <code class="docutils literal notranslate"><span class="pre">append</span></code> field of <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/service/auth/v3/external_auth.proto.html#envoy-v3-api-field-service-auth-v3-okhttpresponse-response-headers-to-add" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">response_headers_to_add</span></a> to set or append encoded response headers from a gRPC auth server.</p></li>
<li><p>ext_authz: fix the HTTP ext_authz filter to respond with <code class="docutils literal notranslate"><span class="pre">403</span> <span class="pre">Forbidden</span></code> when a gRPC auth server sends a denied check response with an empty HTTP status code.</p></li>
<li><p>ext_authz: the network ext_authz filter now correctly sets dynamic metadata returned by the authorization service for non-OK responses. This behavior now matches the http ext_authz filter.</p></li>
<li><p>hcm: remove deprecation for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-xff-num-trusted-hops" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">xff_num_trusted_hops</span></a> and forbid mixing ip detection extensions with old related knobs.</p></li>
<li><p>http: limit use of deferred resets in the http2 codec to server-side connections. Use of deferred reset for client connections can result in incorrect behavior and performance problems.</p></li>
<li><p>listener: fixed an issue on Windows where connections are not handled by all worker threads.</p></li>
<li><p>lua: fix <code class="docutils literal notranslate"><span class="pre">BodyBuffer</span></code> setting a Lua string and printing Lua string containing hex characters. Previously, <code class="docutils literal notranslate"><span class="pre">BodyBuffer</span></code> setting a Lua string or printing strings with hex characters will be truncated.</p></li>
<li><p>xray: fix the AWS X-Ray tracer bug where span’s error, fault and throttle information was not reported properly as per the <a class="reference external" href="https://docs.aws.amazon.com/xray/latest/devguide/xray-api-segmentdocuments.html">AWS X-Ray documentation</a>. Before this fix, server error was reported under the ‘annotations’ section of the segment data.</p></li>
</ul>
</div>
<div class="section" id="removed-config-or-runtime">
<h2>Removed Config or Runtime<a class="headerlink" href="#removed-config-or-runtime" title="Permalink to this headline">¶</a></h2>
<p><em>Normally occurs at the end of the</em> <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/version_history/version_history.html#deprecated" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">deprecation period</span></a></p>
<ul class="simple">
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_upstream_wait_connect_response</span></code> runtime guard and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_preconnect</span></code> runtime guard and legacy code paths.</p></li>
<li><p>listener: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.disable_tls_inspector_injection</span></code> runtime guard and legacy code paths.</p></li>
<li><p>ocsp: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.check_ocsp_policy</span> <span class="pre">deprecation</span></code> runtime guard and legacy code paths.</p></li>
<li><p>ocsp: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.require_ocsp_response_for_must_staple_certs</span> <span class="pre">deprecation</span></code> and legacy code paths.</p></li>
<li><p>quic: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.prefer_quic_kernel_bpf_packet_routing</span></code> runtime guard.</p></li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>access_log: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/formatter/metadata/v3/metadata.proto.html#envoy-v3-api-msg-extensions-formatter-metadata-v3-metadata" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">METADATA</span></a> token to handle all types of metadata (DYNAMIC, CLUSTER, ROUTE).</p></li>
<li><p>bootstrap: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/bootstrap/v3/bootstrap.proto.html#envoy-v3-api-field-config-bootstrap-v3-bootstrap-inline-headers" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">inline_headers</span></a> in the bootstrap to make custom inline headers bootstrap configurable.</p></li>
<li><p>contrib: added new <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a> which contain contrib extensions.</p></li>
<li><p>dns: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-enum-value-config-cluster-v3-cluster-dnslookupfamily-v4-preferred" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">V4_PREFERRED</span></a> option to return V6 addresses only if V4 addresses are not available.</p></li>
<li><p>ext_authz: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-authorizationresponse-dynamic-metadata-from-headers" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">dynamic_metadata_from_headers</span></a> to support emitting dynamic metadata from headers returned by an external authorization service via HTTP.</p></li>
<li><p>grpc reverse bridge: added a new <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/grpc_http1_reverse_bridge/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-grpc-http1-reverse-bridge-v3-filterconfig-response-size-header" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">option</span></a> to support streaming response bodies when withholding gRPC frames from the upstream.</p></li>
<li><p>grpc_json_transcoder: added support to unescape ‘+’ in query parameters to space with a new config field <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/grpc_json_transcoder/v3/transcoder.proto.html#envoy-v3-api-field-extensions-filters-http-grpc-json-transcoder-v3-grpcjsontranscoder-query-param-unescape-plus" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">query_param_unescape_plus</span></a>.</p></li>
<li><p>http: added cluster_header in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">weighted_clusters</span></a> to allow routing to the weighted cluster specified in the request_header.</p></li>
<li><p>http: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-alternateprotocolscacheoptions" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">alternate_protocols_cache_options</span></a> for enabling HTTP/3 connections to servers which advertise HTTP/3 support via <a class="reference external" href="https://tools.ietf.org/html/rfc7838">HTTP Alternative Services</a> and caching the advertisements to disk.</p></li>
<li><p>http: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-string-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">string_match</span></a> in the header matcher.</p></li>
<li><p>http: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-stream-duration-ms" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">x-envoy-upstream-stream-duration-ms</span></a> that allows configuring the max stream duration via a request header.</p></li>
<li><p>http: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-requests-per-connection" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">max_requests_per_connection</span></a> for both upstream and downstream connections.</p></li>
<li><p>http: sanitizing the referer header as documented <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-referer" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">here</span></a>. This feature can be temporarily turned off by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.sanitize_http_header_referer</span></code> to false.</p></li>
<li><p>http: validating outgoing HTTP/2 CONNECT requests to ensure that if <code class="docutils literal notranslate"><span class="pre">:path</span></code> is set that <code class="docutils literal notranslate"><span class="pre">:protocol</span></code> is present. This behavior can be temporarily turned off by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.validate_connect</span></code> to false.</p></li>
<li><p>jwt_authn: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-jwt-cache-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">Jwt Cache</span></a> and its size can be specified by <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtcacheconfig-jwt-cache-size" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">jwt_cache_size</span></a>.</p></li>
<li><p>jwt_authn: added support for extracting JWTs from request cookies using <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-from-cookies" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">from_cookies</span></a>.</p></li>
<li><p>jwt_authn: added support for setting the extracted headers from a successfully verified JWT using <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-header-in-metadata" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">header_in_metadata</span></a> to dynamic metadata.</p></li>
<li><p>listener: new listener metric <code class="docutils literal notranslate"><span class="pre">downstream_cx_transport_socket_connect_timeout</span></code> to track transport socket timeouts.</p></li>
<li><p>lua: added <code class="docutils literal notranslate"><span class="pre">header:getAtIndex()</span></code> and <code class="docutils literal notranslate"><span class="pre">header:getNumValues()</span></code> methods to <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/configuration/http/http_filters/lua_filter.html#config-http-filters-lua-header-wrapper" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">header object</span></a> for retrieving the value of a header at certain index and get the total number of values for a given header.</p></li>
<li><p>matcher: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/type/matcher/v3/metadata.proto.html#envoy-v3-api-field-type-matcher-v3-metadatamatcher-invert" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">invert</span></a> for inverting the match result in the metadata matcher.</p></li>
<li><p>overload: add a new overload action that resets streams using a lot of memory. To enable the tracking of allocated bytes in buffers that a stream is using we need to configure the minimum threshold for tracking via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/overload/v3/overload.proto.html#envoy-v3-api-field-config-overload-v3-overloadmanager-buffer-factory-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">buffer_factory_config</span></a>. We have an overload action <code class="docutils literal notranslate"><span class="pre">Envoy::Server::OverloadActionNameValues::ResetStreams</span></code> that takes advantage of the tracking to reset the most expensive stream first.</p></li>
<li><p>rbac: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/rbac/v3/rbac.proto.html#envoy-v3-api-field-config-rbac-v3-permission-destination-port-range" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">destination_port_range</span></a> for matching range of destination ports.</p></li>
<li><p>rbac: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/rbac/v3/rbac.proto.html#envoy-v3-api-field-config-rbac-v3-permission-matcher" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">matcher</span></a> along with extension category <code class="docutils literal notranslate"><span class="pre">extension_category_envoy.rbac.matchers</span></code> for custom RBAC permission matchers. Added reference implementation for matchers <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/rbac/matchers/upstream_ip_port/v3/upstream_ip_port_matcher.proto.html#extension-envoy-rbac-matchers-upstream-ip-port" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">envoy.rbac.matchers.upstream_ip_port</span></a>.</p></li>
<li><p>route config: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routematch-dynamic-metadata" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">dynamic_metadata</span></a> for routing based on dynamic metadata.</p></li>
<li><p>router: added retry options predicate extensions configured via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-retrypolicy-retry-options-predicates" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">retry_options_predicates.</span></a> These extensions allow modification of requests between retries at the router level. There are not currently any built-in extensions that implement this extension point.</p></li>
<li><p>router: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-retrypolicy-per-try-idle-timeout" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">per_try_idle_timeout</span></a> timeout configuration.</p></li>
<li><p>router: added an optional <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-upstreamhttpprotocoloptions-override-auto-sni-header" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">override_auto_sni_header</span></a> to support setting SNI value from an arbitrary header other than host/authority.</p></li>
<li><p>sxg_filter: added filter to transform response to SXG package to <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/start/install.html#install-contrib" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contrib images</span></a>. This can be enabled by setting <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/http/sxg/v3alpha/sxg.proto.html#envoy-v3-api-msg-extensions-filters-http-sxg-v3alpha-sxg" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">SXG</span></a> configuration.</p></li>
<li><p>thrift_proxy: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/filters/network/thrift_proxy/v3/route.proto.html#envoy-v3-api-field-extensions-filters-network-thrift-proxy-v3-routeaction-request-mirror-policies" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">mirroring requests</span></a>.</p></li>
<li><p>udp: allows updating filter chain in-place through LDS, which is supported by Quic listener. Such listener config will be rejected in other connection-less UDP listener implementations. It can be reverted by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.udp_listener_updates_filter_chain_in_place</span></code>.</p></li>
<li><p>udp: disallow L4 filter chain in config which configures connection-less UDP listener. It can be reverted by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.udp_listener_updates_filter_chain_in_place</span></code>.</p></li>
<li><p>upstream: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/intro/arch_overview/upstream/load_balancing/slow_start.html#arch-overview-load-balancing-slow-start" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">slow start mode</span></a>, which allows to progresively increase traffic for new endpoints.</p></li>
<li><p>upstream: extended <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-round-robin-lb-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">Round Robin load balancer configuration</span></a> with <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-roundrobinlbconfig-slow-start-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">slow start</span></a> support.</p></li>
<li><p>upstream: extended <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-least-request-lb-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">Least Request load balancer configuration</span></a> with <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-leastrequestlbconfig-slow-start-config" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">slow start</span></a> support.</p></li>
<li><p>windows: added a new container image based on Windows Nanoserver 2022.</p></li>
<li><p>xray: request direction (<code class="docutils literal notranslate"><span class="pre">ingress</span></code> or <code class="docutils literal notranslate"><span class="pre">egress</span></code>) is recorded as X-Ray trace segment’s annotation by name <code class="docutils literal notranslate"><span class="pre">direction</span></code>.</p></li>
</ul>
</div>
<div class="section" id="deprecated">
<h2>Deprecated<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>api: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/common/matching/v3/extension_matcher.proto.html#envoy-v3-api-field-extensions-common-matching-v3-extensionwithmatcher-matcher" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">matcher</span></a> field has been deprecated in favor of
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/extensions/common/matching/v3/extension_matcher.proto.html#envoy-v3-api-field-extensions-common-matching-v3-extensionwithmatcher-xds-matcher" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">matcher</span></a> in order to break a build dependency.</p></li>
<li><p>cluster: <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-max-requests-per-connection" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">max_requests_per_connection</span></a> is deprecated in favor of <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-requests-per-connection" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">max_requests_per_connection</span></a>.</p></li>
<li><p>http: the HeaderMatcher fields <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-exact-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">exact_match</span></a>, <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">safe_regex_match</span></a>,
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">prefix_match</span></a>, <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">suffix_match</span></a> and
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-contains-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">contains_match</span></a> are deprecated by <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-headermatcher-string-match" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">string_match</span></a>.</p></li>
<li><p>listener: <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-reuse-port" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">reuse_port</span></a> has been
deprecated in favor of <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.20.1/api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-enable-reuse-port" title="(in envoy vtag-v1.20.1)"><span class="xref std std-ref">enable_reuse_port</span></a>.
At the same time, the default has been changed from false to true. See above for more information.</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="v1.20.1.html" class="btn btn-neutral float-left" title="1.20.1 (November 30, 2021)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="v1.19.1.html" class="btn btn-neutral float-right" title="1.19.1 (Aug 24, 2021)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>