

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cluster configuration &mdash; envoy 1.16.0-dev-07bf5b documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Outlier detection" href="outlier_detection.proto.html" />
    <link rel="prev" title="Clusters" href="../../../clusters/clusters.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html">
          

          
            
            <img src="../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.16.0-dev-07bf5b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install/install.html">Building and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../version_history/version_history.html">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../api.html">v3 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../clusters/clusters.html">Clusters</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Cluster configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="outlier_detection.proto.html">Outlier detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="circuit_breaker.proto.html">Circuit breakers</a></li>
<li class="toctree-l4"><a class="reference internal" href="filter.proto.html">Upstream filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../endpoint/v3/endpoint.proto.html">Endpoint configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../endpoint/v3/endpoint_components.proto.html">Endpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/v3/health_check.proto.html">Health check</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../config.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../api/api.html">API</a> &raquo;</li>
        
          <li><a href="../../../api.html">v3 API reference</a> &raquo;</li>
        
          <li><a href="../../../clusters/clusters.html">Clusters</a> &raquo;</li>
        
      <li>Cluster configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/api-v3/config/cluster/v3/cluster.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cluster-configuration">
<span id="envoy-v3-api-file-envoy-config-cluster-v3-cluster-proto"></span><h1>Cluster configuration<a class="headerlink" href="#cluster-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="config-cluster-v3-cluster">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster"></span><h2>config.cluster.v3.Cluster<a class="headerlink" href="#config-cluster-v3-cluster" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L46">[config.cluster.v3.Cluster proto]</a></p>
<p>Configuration for a single upstream cluster.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;transport_socket_matches&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;alt_stat_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cluster_type&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;eds_cluster_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;connect_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_connection_buffer_limit_bytes&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;lb_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;load_assignment&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;health_checks&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;max_requests_per_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;circuit_breakers&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upstream_http_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;common_http_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;http_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;http2_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_extension_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dns_refresh_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dns_failure_refresh_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;respect_dns_ttl&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dns_lookup_family&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dns_resolvers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;use_tcp_for_dns_lookups&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;outlier_detection&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cleanup_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upstream_bind_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;lb_subset_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ring_hash_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;original_dst_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;least_request_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;common_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;transport_socket&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;protocol_selection&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upstream_connection_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;close_connections_on_host_health_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ignore_health_on_host_removal&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;track_timeout_budgets&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upstream_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-transport-socket-matches">
<dt>transport_socket_matches</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-transportsocketmatch"><span class="std std-ref">config.cluster.v3.Cluster.TransportSocketMatch</span></a>) Configuration to use different transport sockets for different endpoints.
The entry of <em>envoy.transport_socket_match</em> in the
<a class="reference internal" href="../../endpoint/v3/endpoint_components.proto.html#envoy-v3-api-field-config-endpoint-v3-lbendpoint-metadata"><span class="std std-ref">LbEndpoint.Metadata</span></a>
is used to match against the transport sockets as they appear in the list. The first
<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-transportsocketmatch"><span class="std std-ref">match</span></a> is used.
For example, with the following match</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">transport_socket_matches</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;enableMTLS&quot;</span>
  <span class="nt">match</span><span class="p">:</span>
    <span class="nt">acceptMTLS</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">transport_socket</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">envoy.transport_sockets.tls</span>
    <span class="nt">config</span><span class="p">:</span> <span class="p p-Indicator">{</span> <span class="nv">...</span> <span class="p p-Indicator">}</span> <span class="c1"># tls socket configuration</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;defaultToPlaintext&quot;</span>
  <span class="nt">match</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">transport_socket</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">envoy.transport_sockets.raw_buffer</span>
</pre></div>
</div>
<p>Connections to the endpoints whose metadata value under <em>envoy.transport_socket_match</em>
having “acceptMTLS”/”true” key/value pair use the “enableMTLS” socket configuration.</p>
<p>If a <a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-transportsocketmatch"><span class="std std-ref">socket match</span></a> with empty match
criteria is provided, that always match any endpoint. For example, the “defaultToPlaintext”
socket match in case above.</p>
<p>If an endpoint metadata’s value under <em>envoy.transport_socket_match</em> does not match any
<em>TransportSocketMatch</em>, socket configuration fallbacks to use the <em>tls_context</em> or
<em>transport_socket</em> specified in this cluster.</p>
<p>This field allows gradual and flexible transport socket configuration changes.</p>
<p>The metadata of endpoints in EDS can indicate transport socket capabilities. For example,
an endpoint’s metadata can have two key value pairs as “acceptMTLS”: “true”,
“acceptPlaintext”: “true”. While some other endpoints, only accepting plaintext traffic
has “acceptPlaintext”: “true” metadata information.</p>
<p>Then the xDS server can configure the CDS to a client, Envoy A, to send mutual TLS
traffic for endpoints with “acceptMTLS”: “true”, by adding a corresponding
<em>TransportSocketMatch</em> in this field. Other client Envoys receive CDS without
<em>transport_socket_match</em> set, and still send plain text traffic to the same cluster.</p>
<p>This field can be used to specify custom transport socket configurations for health
checks by adding matching key/value pairs in a health check’s
<a class="reference internal" href="../../core/v3/health_check.proto.html#envoy-v3-api-field-config-core-v3-healthcheck-transport-socket-match-criteria"><span class="std std-ref">transport socket match criteria</span></a> field.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Supplies the name of the cluster which must be unique across all clusters.
The cluster name is used when emitting
<a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_stats.html#config-cluster-manager-cluster-stats"><span class="std std-ref">statistics</span></a> if <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-alt-stat-name"><span class="std std-ref">alt_stat_name</span></a> is not provided.
Any <code class="docutils literal notranslate"><span class="pre">:</span></code> in the cluster name will be converted to <code class="docutils literal notranslate"><span class="pre">_</span></code> when emitting statistics.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-alt-stat-name">
<dt>alt_stat_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional alternative to the cluster name to be used while emitting stats.
Any <code class="docutils literal notranslate"><span class="pre">:</span></code> in the name will be converted to <code class="docutils literal notranslate"><span class="pre">_</span></code> when emitting statistics. This should not be
confused with <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-alt-stat-name"><span class="std std-ref">Router Filter Header</span></a>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-type">
<dt>type</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-discoverytype"><span class="std std-ref">config.cluster.v3.Cluster.DiscoveryType</span></a>) The <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types"><span class="std std-ref">service discovery type</span></a>
to use for resolving the cluster.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-type"><span class="std std-ref">type</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-cluster-type"><span class="std std-ref">cluster_type</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-cluster-type">
<dt>cluster_type</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-customclustertype"><span class="std std-ref">config.cluster.v3.Cluster.CustomClusterType</span></a>) The custom cluster type.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-type"><span class="std std-ref">type</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-cluster-type"><span class="std std-ref">cluster_type</span></a> may be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-eds-cluster-config">
<dt>eds_cluster_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-edsclusterconfig"><span class="std std-ref">config.cluster.v3.Cluster.EdsClusterConfig</span></a>) Configuration to use for EDS updates for the Cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-connect-timeout">
<dt>connect_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The timeout for new network connections to hosts in the cluster.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-per-connection-buffer-limit-bytes">
<dt>per_connection_buffer_limit_bytes</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Soft limit on size of the cluster’s connections read and write buffers. If
unspecified, an implementation defined default is applied (1MiB).</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>upstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">per_connection_buffer_limit_bytes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32768.0</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lb-policy">
<dt>lb_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-lbpolicy"><span class="std std-ref">config.cluster.v3.Cluster.LbPolicy</span></a>) The <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types"><span class="std std-ref">load balancer type</span></a> to use
when picking a host in the cluster.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-load-assignment">
<dt>load_assignment</dt><dd><p>(<a class="reference internal" href="../../endpoint/v3/endpoint.proto.html#envoy-v3-api-msg-config-endpoint-v3-clusterloadassignment"><span class="std std-ref">config.endpoint.v3.ClusterLoadAssignment</span></a>) Setting this is required for specifying members of
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-static"><span class="std std-ref">STATIC</span></a>,
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>
or <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a> clusters.
This field supersedes the <em>hosts</em> field in the v2 API.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Setting this allows non-EDS cluster types to contain embedded EDS equivalent
<a class="reference internal" href="../../endpoint/v3/endpoint.proto.html#envoy-v3-api-msg-config-endpoint-v3-clusterloadassignment"><span class="std std-ref">endpoint assignments</span></a>.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-health-checks">
<dt>health_checks</dt><dd><p>(<a class="reference internal" href="../../core/v3/health_check.proto.html#envoy-v3-api-msg-config-core-v3-healthcheck"><span class="std std-ref">config.core.v3.HealthCheck</span></a>) Optional <a class="reference internal" href="../../../../intro/arch_overview/upstream/health_checking.html#arch-overview-health-checking"><span class="std std-ref">active health checking</span></a>
configuration for the cluster. If no
configuration is specified no health checking will be done and all cluster
members will be considered healthy at all times.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-max-requests-per-connection">
<dt>max_requests_per_connection</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Optional maximum requests for a single upstream connection. This parameter
is respected by both the HTTP/1.1 and HTTP/2 connection pool
implementations. If not specified, there is no limit. Setting this
parameter to 1 will effectively disable keep alive.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-circuit-breakers">
<dt>circuit_breakers</dt><dd><p>(<a class="reference internal" href="circuit_breaker.proto.html#envoy-v3-api-msg-config-cluster-v3-circuitbreakers"><span class="std std-ref">config.cluster.v3.CircuitBreakers</span></a>) Optional <a class="reference internal" href="../../../../intro/arch_overview/upstream/circuit_breaking.html#arch-overview-circuit-break"><span class="std std-ref">circuit breaking</span></a> for the cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-upstream-http-protocol-options">
<dt>upstream_http_protocol_options</dt><dd><p>(<a class="reference internal" href="../../core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-upstreamhttpprotocoloptions"><span class="std std-ref">config.core.v3.UpstreamHttpProtocolOptions</span></a>) HTTP protocol options that are applied only to upstream HTTP connections.
These options apply to all HTTP versions.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-common-http-protocol-options">
<dt>common_http_protocol_options</dt><dd><p>(<a class="reference internal" href="../../core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-httpprotocoloptions"><span class="std std-ref">config.core.v3.HttpProtocolOptions</span></a>) Additional options when handling HTTP requests upstream. These options will be applicable to
both HTTP1 and HTTP2 requests.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-http-protocol-options">
<dt>http_protocol_options</dt><dd><p>(<a class="reference internal" href="../../core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-http1protocoloptions"><span class="std std-ref">config.core.v3.Http1ProtocolOptions</span></a>) Additional options when handling HTTP1 requests.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-http2-protocol-options">
<dt>http2_protocol_options</dt><dd><p>(<a class="reference internal" href="../../core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-http2protocoloptions"><span class="std std-ref">config.core.v3.Http2ProtocolOptions</span></a>) Even if default HTTP2 protocol options are desired, this field must be
set so that Envoy will assume that the upstream supports HTTP/2 when
making new HTTP connection pool connections. Currently, Envoy only
supports prior knowledge for upstream connections. Even if TLS is used
with ALPN, <cite>http2_protocol_options</cite> must be specified. As an aside this allows HTTP/2
connections to happen over plain text.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>upstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">http2_protocol_options</span><span class="p">:</span>
  <span class="nt">initial_connection_window_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1048576.0</span>
  <span class="nt">initial_stream_window_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">65536.0</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-typed-extension-protocol-options">
<dt>typed_extension_protocol_options</dt><dd><p>(map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>&gt;) The extension_protocol_options field is used to provide extension-specific protocol options
for upstream connections. The key should match the extension filter name, such as
“envoy.filters.network.thrift_proxy”. See the extension’s documentation for details on
specific options.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-dns-refresh-rate">
<dt>dns_refresh_rate</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) If the DNS refresh rate is specified and the cluster type is either
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>,
or <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>,
this value is used as the cluster’s DNS refresh
rate. The value configured must be at least 1ms. If this setting is not specified, the
value defaults to 5000ms. For cluster types other than
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>
and <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>
this setting is ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-dns-failure-refresh-rate">
<dt>dns_failure_refresh_rate</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-refreshrate"><span class="std std-ref">config.cluster.v3.Cluster.RefreshRate</span></a>) If the DNS failure refresh rate is specified and the cluster type is either
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>,
or <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>,
this is used as the cluster’s DNS refresh rate when requests are failing. If this setting is
not specified, the failure refresh rate defaults to the DNS refresh rate. For cluster types
other than <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a> and
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a> this setting is
ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-respect-dns-ttl">
<dt>respect_dns_ttl</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Optional configuration for setting cluster’s DNS refresh rate. If the value is set to true,
cluster’s DNS refresh rate will be set to resource record’s TTL which comes from DNS
resolution.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-dns-lookup-family">
<dt>dns_lookup_family</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-dnslookupfamily"><span class="std std-ref">config.cluster.v3.Cluster.DnsLookupFamily</span></a>) The DNS IP address resolution policy. If this setting is not specified, the
value defaults to
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-dnslookupfamily-auto"><span class="std std-ref">AUTO</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-dns-resolvers">
<dt>dns_resolvers</dt><dd><p>(<a class="reference internal" href="../../core/v3/address.proto.html#envoy-v3-api-msg-config-core-v3-address"><span class="std std-ref">config.core.v3.Address</span></a>) If DNS resolvers are specified and the cluster type is either
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>,
or <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>,
this value is used to specify the cluster’s dns resolvers.
If this setting is not specified, the value defaults to the default
resolver, which uses /etc/resolv.conf for configuration. For cluster types
other than
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a>
and <a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>
this setting is ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-use-tcp-for-dns-lookups">
<dt>use_tcp_for_dns_lookups</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Always use TCP queries instead of UDP queries for DNS lookups.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-outlier-detection">
<dt>outlier_detection</dt><dd><p>(<a class="reference internal" href="outlier_detection.proto.html#envoy-v3-api-msg-config-cluster-v3-outlierdetection"><span class="std std-ref">config.cluster.v3.OutlierDetection</span></a>) If specified, outlier detection will be enabled for this upstream cluster.
Each of the configuration values can be overridden via
<a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_runtime.html#config-cluster-manager-cluster-runtime-outlier-detection"><span class="std std-ref">runtime values</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-cleanup-interval">
<dt>cleanup_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The interval for removing stale hosts from a cluster type
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-original-dst"><span class="std std-ref">ORIGINAL_DST</span></a>.
Hosts are considered stale if they have not been used
as upstream destinations during this interval. New hosts are added
to original destination clusters on demand as new connections are
redirected to Envoy, causing the number of hosts in the cluster to
grow over time. Hosts that are not stale (they are actively used as
destinations) are kept in the cluster, which allows connections to
them remain open, saving the latency that would otherwise be spent
on opening new connections. If this setting is not specified, the
value defaults to 5000ms. For cluster types other than
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-original-dst"><span class="std std-ref">ORIGINAL_DST</span></a>
this setting is ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-upstream-bind-config">
<dt>upstream_bind_config</dt><dd><p>(<a class="reference internal" href="../../core/v3/address.proto.html#envoy-v3-api-msg-config-core-v3-bindconfig"><span class="std std-ref">config.core.v3.BindConfig</span></a>) Optional configuration used to bind newly established upstream connections.
This overrides any bind_config specified in the bootstrap proto.
If the address and port are empty, no bind will be performed.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lb-subset-config">
<dt>lb_subset_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-lbsubsetconfig"><span class="std std-ref">config.cluster.v3.Cluster.LbSubsetConfig</span></a>) Configuration for load balancing subsetting.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-ring-hash-lb-config">
<dt>ring_hash_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-ringhashlbconfig"><span class="std std-ref">config.cluster.v3.Cluster.RingHashLbConfig</span></a>) Optional configuration for the Ring Hash load balancing policy.</p>
<p>Optional configuration for the load balancing algorithm selected by
LbPolicy. Currently only
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-ring-hash"><span class="std std-ref">RING_HASH</span></a> and
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-least-request"><span class="std std-ref">LEAST_REQUEST</span></a>
has additional configuration options.
Specifying ring_hash_lb_config or least_request_lb_config without setting the corresponding
LbPolicy will generate an error at runtime.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-ring-hash-lb-config"><span class="std std-ref">ring_hash_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-original-dst-lb-config"><span class="std std-ref">original_dst_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-least-request-lb-config"><span class="std std-ref">least_request_lb_config</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-original-dst-lb-config">
<dt>original_dst_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-originaldstlbconfig"><span class="std std-ref">config.cluster.v3.Cluster.OriginalDstLbConfig</span></a>) Optional configuration for the Original Destination load balancing policy.</p>
<p>Optional configuration for the load balancing algorithm selected by
LbPolicy. Currently only
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-ring-hash"><span class="std std-ref">RING_HASH</span></a> and
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-least-request"><span class="std std-ref">LEAST_REQUEST</span></a>
has additional configuration options.
Specifying ring_hash_lb_config or least_request_lb_config without setting the corresponding
LbPolicy will generate an error at runtime.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-ring-hash-lb-config"><span class="std std-ref">ring_hash_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-original-dst-lb-config"><span class="std std-ref">original_dst_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-least-request-lb-config"><span class="std std-ref">least_request_lb_config</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-least-request-lb-config">
<dt>least_request_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-leastrequestlbconfig"><span class="std std-ref">config.cluster.v3.Cluster.LeastRequestLbConfig</span></a>) Optional configuration for the LeastRequest load balancing policy.</p>
<p>Optional configuration for the load balancing algorithm selected by
LbPolicy. Currently only
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-ring-hash"><span class="std std-ref">RING_HASH</span></a> and
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-least-request"><span class="std std-ref">LEAST_REQUEST</span></a>
has additional configuration options.
Specifying ring_hash_lb_config or least_request_lb_config without setting the corresponding
LbPolicy will generate an error at runtime.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-ring-hash-lb-config"><span class="std std-ref">ring_hash_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-original-dst-lb-config"><span class="std std-ref">original_dst_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-least-request-lb-config"><span class="std std-ref">least_request_lb_config</span></a> may be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-common-lb-config">
<dt>common_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig"><span class="std std-ref">config.cluster.v3.Cluster.CommonLbConfig</span></a>) Common configuration for all load balancer implementations.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-transport-socket">
<dt>transport_socket</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-transportsocket"><span class="std std-ref">config.core.v3.TransportSocket</span></a>) Optional custom transport socket implementation to use for upstream connections.
To setup TLS, set a transport socket with name <cite>tls</cite> and
<a class="reference internal" href="../../../extensions/transport_sockets/tls/v3/tls.proto.html#envoy-v3-api-msg-extensions-transport-sockets-tls-v3-upstreamtlscontext"><span class="std std-ref">UpstreamTlsContexts</span></a> in the <cite>typed_config</cite>.
If no transport socket configuration is specified, new connections
will be set up with plaintext.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-metadata">
<dt>metadata</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">config.core.v3.Metadata</span></a>) The Metadata field can be used to provide additional information about the
cluster. It can be used for stats, logging, and varying filter behavior.
Fields should use reverse DNS notation to denote which entity within Envoy
will need the information. For instance, if the metadata is intended for
the Router filter, the filter name should be specified as <em>envoy.filters.http.router</em>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-protocol-selection">
<dt>protocol_selection</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-clusterprotocolselection"><span class="std std-ref">config.cluster.v3.Cluster.ClusterProtocolSelection</span></a>) Determines how Envoy selects the protocol used to speak to upstream hosts.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-upstream-connection-options">
<dt>upstream_connection_options</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-upstreamconnectionoptions"><span class="std std-ref">config.cluster.v3.UpstreamConnectionOptions</span></a>) Optional options for upstream connections.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-close-connections-on-host-health-failure">
<dt>close_connections_on_host_health_failure</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If an upstream host becomes unhealthy (as determined by the configured health checks
or outlier detection), immediately close all connections to the failed host.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is currently only supported for connections created by tcp_proxy.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current implementation of this feature closes all connections immediately when
the unhealthy status is detected. If there are a large number of connections open
to an upstream host that becomes unhealthy, Envoy may spend a substantial amount of
time exclusively closing these connections, and not processing any other traffic.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-ignore-health-on-host-removal">
<dt>ignore_health_on_host_removal</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to true, Envoy will ignore the health value of a host when processing its removal
from service discovery. This means that if active health checking is used, Envoy will <em>not</em>
wait for the endpoint to go unhealthy before removing it.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-filters">
<dt>filters</dt><dd><p>(<a class="reference internal" href="filter.proto.html#envoy-v3-api-msg-config-cluster-v3-filter"><span class="std std-ref">config.cluster.v3.Filter</span></a>) An (optional) network filter chain, listed in the order the filters should be applied.
The chain will be applied to all outgoing connections that Envoy makes to the upstream
servers of this cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-track-timeout-budgets">
<dt>track_timeout_budgets</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If track_timeout_budgets is true, the <a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_stats.html#config-cluster-manager-cluster-stats-timeout-budgets"><span class="std std-ref">timeout budget histograms</span></a> will be published for each
request. These show what percentage of a request’s per try and global timeout was used. A value
of 0 would indicate that none of the timeout was used or that the timeout was infinite. A value
of 100 would indicate that the request took the entirety of the timeout given to it.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-upstream-config">
<dt>upstream_config</dt><dd><p>(<a class="reference internal" href="../../core/v3/extension.proto.html#envoy-v3-api-msg-config-core-v3-typedextensionconfig"><span class="std std-ref">config.core.v3.TypedExtensionConfig</span></a>) Optional customization and configuration of upstream connection pool, and upstream type.</p>
<p>Currently this field only applies for HTTP traffic but is designed for eventual use for custom
TCP upstreams.</p>
<p>For HTTP traffic, Envoy will generally take downstream HTTP and send it upstream as upstream
HTTP, using the http connection pool and the codec from <cite>http2_protocol_options</cite></p>
<p>For routes where CONNECT termination is configured, Envoy will take downstream CONNECT
requests and forward the CONNECT payload upstream over raw TCP using the tcp connection pool.</p>
<p>The default pool used is the generic connection pool which creates the HTTP upstream for most
HTTP requests, and the TCP upstream if CONNECT termination is configured.</p>
<p>If users desire custom connection pool or upstream behavior, for example terminating
CONNECT only if a custom filter indicates it is appropriate, the custom factories
can be registered and configured here.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-transportsocketmatch">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-transportsocketmatch"></span><h2>config.cluster.v3.Cluster.TransportSocketMatch<a class="headerlink" href="#config-cluster-v3-cluster-transportsocketmatch" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L148">[config.cluster.v3.Cluster.TransportSocketMatch proto]</a></p>
<p>TransportSocketMatch specifies what transport socket config will be used
when the match conditions are satisfied.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;transport_socket&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-transportsocketmatch-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The name of the match, used in stats generation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-transportsocketmatch-match">
<dt>match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#struct">Struct</a>) Optional endpoint metadata match criteria.
The connection to the endpoint with metadata matching what is set in this field
will use the transport socket configuration specified here.
The endpoint’s metadata entry in <em>envoy.transport_socket_match</em> is used to match
against the values specified in this field.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-transportsocketmatch-transport-socket">
<dt>transport_socket</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-transportsocket"><span class="std std-ref">config.core.v3.TransportSocket</span></a>) The configuration of the transport socket.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-customclustertype">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-customclustertype"></span><h2>config.cluster.v3.Cluster.CustomClusterType<a class="headerlink" href="#config-cluster-v3-cluster-customclustertype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L167">[config.cluster.v3.Cluster.CustomClusterType proto]</a></p>
<p>Extended cluster type.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-customclustertype-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The type of the cluster to instantiate. The name must match a supported cluster type.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-customclustertype-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>) Cluster specific configuration which depends on the cluster being instantiated.
See the supported cluster for further documentation.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-edsclusterconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-edsclusterconfig"></span><h2>config.cluster.v3.Cluster.EdsClusterConfig<a class="headerlink" href="#config-cluster-v3-cluster-edsclusterconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L180">[config.cluster.v3.Cluster.EdsClusterConfig proto]</a></p>
<p>Only valid when discovery type is EDS.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;eds_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-edsclusterconfig-eds-config">
<dt>eds_config</dt><dd><p>(<a class="reference internal" href="../../core/v3/config_source.proto.html#envoy-v3-api-msg-config-core-v3-configsource"><span class="std std-ref">config.core.v3.ConfigSource</span></a>) Configuration for the source of EDS updates for this Cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-edsclusterconfig-service-name">
<dt>service_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Optional alternative to cluster name to present to EDS. This does not
have the same restrictions as cluster name, i.e. it may be arbitrary
length.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-lbsubsetconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-lbsubsetconfig"></span><h2>config.cluster.v3.Cluster.LbSubsetConfig<a class="headerlink" href="#config-cluster-v3-cluster-lbsubsetconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L201">[config.cluster.v3.Cluster.LbSubsetConfig proto]</a></p>
<p>Optionally divide the endpoints in this cluster into subsets defined by
endpoint metadata and selected by route and weighted cluster metadata.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;fallback_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;default_subset&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;subset_selectors&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;locality_weight_aware&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scale_locality_weight&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;panic_mode_any&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;list_as_any&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-fallback-policy">
<dt>fallback_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy"><span class="std std-ref">config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetFallbackPolicy</span></a>) The behavior used when no endpoint subset matches the selected route’s
metadata. The value defaults to
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-no-fallback"><span class="std std-ref">NO_FALLBACK</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-default-subset">
<dt>default_subset</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#struct">Struct</a>) Specifies the default subset of endpoints used during fallback if
fallback_policy is
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-default-subset"><span class="std std-ref">DEFAULT_SUBSET</span></a>.
Each field in default_subset is
compared to the matching LbEndpoint.Metadata under the <em>envoy.lb</em>
namespace. It is valid for no hosts to match, in which case the behavior
is the same as a fallback_policy of
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-no-fallback"><span class="std std-ref">NO_FALLBACK</span></a>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-subset-selectors">
<dt>subset_selectors</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector"><span class="std std-ref">config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector</span></a>) For each entry, LbEndpoint.Metadata’s
<em>envoy.lb</em> namespace is traversed and a subset is created for each unique
combination of key and value. For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">&quot;subset_selectors&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;keys&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;version&quot;</span> <span class="p">]</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nt">&quot;keys&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;stage&quot;</span><span class="p">,</span> <span class="s2">&quot;hardware_type&quot;</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</div>
<p>A subset is matched when the metadata from the selected route and
weighted cluster contains the same keys and values as the subset’s
metadata. The same host may appear in multiple subsets.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-locality-weight-aware">
<dt>locality_weight_aware</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If true, routing to subsets will take into account the localities and locality weights of the
endpoints when making the routing decision.</p>
<p>There are some potential pitfalls associated with enabling this feature, as the resulting
traffic split after applying both a subset match and locality weights might be undesirable.</p>
<p>Consider for example a situation in which you have 50/50 split across two localities X/Y
which have 100 hosts each without subsetting. If the subset LB results in X having only 1
host selected but Y having 100, then a lot more load is being dumped on the single host in X
than originally anticipated in the load balancing assignment delivered via EDS.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-scale-locality-weight">
<dt>scale_locality_weight</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) When used with locality_weight_aware, scales the weight of each locality by the ratio
of hosts in the subset vs hosts in the original subset. This aims to even out the load
going to an individual locality if said locality is disproportionately affected by the
subset predicate.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-panic-mode-any">
<dt>panic_mode_any</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If true, when a fallback policy is configured and its corresponding subset fails to find
a host this will cause any host to be selected instead.</p>
<p>This is useful when using the default subset as the fallback policy, given the default
subset might become empty. With this option enabled, if that happens the LB will attempt
to select a host from the entire cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-list-as-any">
<dt>list_as_any</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If true, metadata specified for a metadata key will be matched against the corresponding
endpoint metadata if the endpoint metadata matches the value exactly OR it is a list value
and any of the elements in the list matches the criteria.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector"></span><h2>config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector<a class="headerlink" href="#config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L217">[config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector proto]</a></p>
<p>Specifications for subsets.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;keys&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;fallback_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;fallback_keys_subset&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-keys">
<dt>keys</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) List of keys to match with the weighted cluster metadata.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-fallback-policy">
<dt>fallback_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy"><span class="std std-ref">config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector.LbSubsetSelectorFallbackPolicy</span></a>) The behavior used when no endpoint subset matches the selected route’s
metadata.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-fallback-keys-subset">
<dt>fallback_keys_subset</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Subset of
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-keys"><span class="std std-ref">keys</span></a> used by
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-keys-subset"><span class="std std-ref">KEYS_SUBSET</span></a>
fallback policy.
It has to be a non empty list if KEYS_SUBSET fallback policy is selected.
For any other fallback policy the parameter is not used and should not be set.
Only values also present in
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-keys"><span class="std std-ref">keys</span></a> are allowed, but
<cite>fallback_keys_subset</cite> cannot be equal to <cite>keys</cite>.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy"></span><h2>Enum config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector.LbSubsetSelectorFallbackPolicy<a class="headerlink" href="#enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L222">[config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetSelector.LbSubsetSelectorFallbackPolicy proto]</a></p>
<p>Allows to override top level fallback policy per selector.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-not-defined">
<dt>NOT_DEFINED</dt><dd><p><em>(DEFAULT)</em> ⁣If NOT_DEFINED top level config fallback policy is used instead.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-no-fallback">
<dt>NO_FALLBACK</dt><dd><p>⁣If NO_FALLBACK is selected, a result equivalent to no healthy hosts is reported.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-any-endpoint">
<dt>ANY_ENDPOINT</dt><dd><p>⁣If ANY_ENDPOINT is selected, any cluster endpoint may be returned
(subject to policy, health checks, etc).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-default-subset">
<dt>DEFAULT_SUBSET</dt><dd><p>⁣If DEFAULT_SUBSET is selected, load balancing is performed over the
endpoints matching the values from the default_subset field.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-lbsubsetselectorfallbackpolicy-keys-subset">
<dt>KEYS_SUBSET</dt><dd><p>⁣If KEYS_SUBSET is selected, subset selector matching is performed again with metadata
keys reduced to
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetselector-fallback-keys-subset"><span class="std std-ref">fallback_keys_subset</span></a>.
It allows for a fallback to a different, less specific selector if some of the keys of
the selector are considered optional.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy"></span><h2>Enum config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetFallbackPolicy<a class="headerlink" href="#enum-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L210">[config.cluster.v3.Cluster.LbSubsetConfig.LbSubsetFallbackPolicy proto]</a></p>
<p>If NO_FALLBACK is selected, a result
equivalent to no healthy hosts is reported. If ANY_ENDPOINT is selected,
any cluster endpoint may be returned (subject to policy, health checks,
etc). If DEFAULT_SUBSET is selected, load balancing is performed over the
endpoints matching the values from the default_subset field.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-no-fallback">
<dt>NO_FALLBACK</dt><dd><p><em>(DEFAULT)</em> ⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-any-endpoint">
<dt>ANY_ENDPOINT</dt><dd><p>⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbsubsetconfig-lbsubsetfallbackpolicy-default-subset">
<dt>DEFAULT_SUBSET</dt><dd><p>⁣</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-leastrequestlbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-leastrequestlbconfig"></span><h2>config.cluster.v3.Cluster.LeastRequestLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-leastrequestlbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L329">[config.cluster.v3.Cluster.LeastRequestLbConfig proto]</a></p>
<p>Specific configuration for the LeastRequest load balancing policy.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;choice_count&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-leastrequestlbconfig-choice-count">
<dt>choice_count</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The number of random healthy hosts from which the host with the fewest active requests will
be chosen. Defaults to 2 so that we perform two-choice selection if the field is not set.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-ringhashlbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-ringhashlbconfig"></span><h2>config.cluster.v3.Cluster.RingHashLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-ringhashlbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L340">[config.cluster.v3.Cluster.RingHashLbConfig proto]</a></p>
<p>Specific configuration for the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-ring-hash"><span class="std std-ref">RingHash</span></a>
load balancing policy.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;minimum_ring_size&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hash_function&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;maximum_ring_size&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-ringhashlbconfig-minimum-ring-size">
<dt>minimum_ring_size</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint64value">UInt64Value</a>) Minimum hash ring size. The larger the ring is (that is, the more hashes there are for each
provided host) the better the request distribution will reflect the desired weights. Defaults
to 1024 entries, and limited to 8M entries. See also
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-ringhashlbconfig-maximum-ring-size"><span class="std std-ref">maximum_ring_size</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-ringhashlbconfig-hash-function">
<dt>hash_function</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-cluster-v3-cluster-ringhashlbconfig-hashfunction"><span class="std std-ref">config.cluster.v3.Cluster.RingHashLbConfig.HashFunction</span></a>) The hash function used to hash hosts onto the ketama ring. The value defaults to
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-ringhashlbconfig-hashfunction-xx-hash"><span class="std std-ref">XX_HASH</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-ringhashlbconfig-maximum-ring-size">
<dt>maximum_ring_size</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint64value">UInt64Value</a>) Maximum hash ring size. Defaults to 8M entries, and limited to 8M entries, but can be lowered
to further constrain resource use. See also
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-ringhashlbconfig-minimum-ring-size"><span class="std std-ref">minimum_ring_size</span></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-ringhashlbconfig-hashfunction">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-ringhashlbconfig-hashfunction"></span><h2>Enum config.cluster.v3.Cluster.RingHashLbConfig.HashFunction<a class="headerlink" href="#enum-config-cluster-v3-cluster-ringhashlbconfig-hashfunction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L345">[config.cluster.v3.Cluster.RingHashLbConfig.HashFunction proto]</a></p>
<p>The hash function used to hash hosts onto the ketama ring.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-ringhashlbconfig-hashfunction-xx-hash">
<dt>XX_HASH</dt><dd><p><em>(DEFAULT)</em> ⁣Use <a class="reference external" href="https://github.com/Cyan4973/xxHash">xxHash</a>, this is the default hash function.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-ringhashlbconfig-hashfunction-murmur-hash-2">
<dt>MURMUR_HASH_2</dt><dd><p>⁣Use <a class="reference external" href="https://sites.google.com/site/murmurhash/">MurmurHash2</a>, this is compatible with
std:hash&lt;string&gt; in GNU libstdc++ 3.4.20 or above. This is typically the case when compiled
on Linux and not macOS.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-originaldstlbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-originaldstlbconfig"></span><h2>config.cluster.v3.Cluster.OriginalDstLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-originaldstlbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L376">[config.cluster.v3.Cluster.OriginalDstLbConfig proto]</a></p>
<p>Specific configuration for the
<a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/original_dst.html#arch-overview-load-balancing-types-original-destination"><span class="std std-ref">Original Destination</span></a>
load balancing policy.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;use_http_header&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-originaldstlbconfig-use-http-header">
<dt>use_http_header</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) When true, <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-envoy-original-dst-host"><span class="std std-ref">x-envoy-original-dst-host</span></a> can be used to override destination
address.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This header isn’t sanitized by default, so enabling this feature allows HTTP clients to
route traffic to arbitrary hosts and/or ports, which may have serious security
consequences.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-commonlbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig"></span><h2>config.cluster.v3.Cluster.CommonLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-commonlbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L394">[config.cluster.v3.Cluster.CommonLbConfig proto]</a></p>
<p>Common configuration for all load balancer implementations.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;healthy_panic_threshold&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;zone_aware_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;locality_weighted_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;update_merge_window&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ignore_new_hosts_until_first_hc&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;close_connections_on_host_set_change&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;consistent_hashing_lb_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-healthy-panic-threshold">
<dt>healthy_panic_threshold</dt><dd><p>(<a class="reference internal" href="../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-percent"><span class="std std-ref">type.v3.Percent</span></a>) Configures the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/panic_threshold.html#arch-overview-load-balancing-panic-threshold"><span class="std std-ref">healthy panic threshold</span></a>.
If not specified, the default is 50%.
To disable panic mode, set to 0%.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The specified percent will be truncated to the nearest 1%.</p>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zone-aware-lb-config">
<dt>zone_aware_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig"><span class="std std-ref">config.cluster.v3.Cluster.CommonLbConfig.ZoneAwareLbConfig</span></a>)</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zone-aware-lb-config"><span class="std std-ref">zone_aware_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-locality-weighted-lb-config"><span class="std std-ref">locality_weighted_lb_config</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-locality-weighted-lb-config">
<dt>locality_weighted_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-localityweightedlbconfig"><span class="std std-ref">config.cluster.v3.Cluster.CommonLbConfig.LocalityWeightedLbConfig</span></a>)</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zone-aware-lb-config"><span class="std std-ref">zone_aware_lb_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-locality-weighted-lb-config"><span class="std std-ref">locality_weighted_lb_config</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-update-merge-window">
<dt>update_merge_window</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) If set, all health check/weight/metadata updates that happen within this duration will be
merged and delivered in one shot when the duration expires. The start of the duration is when
the first update happens. This is useful for big clusters, with potentially noisy deploys
that might trigger excessive CPU usage due to a constant stream of healthcheck state changes
or metadata updates. The first set of updates to be seen apply immediately (e.g.: a new
cluster). Please always keep in mind that the use of sandbox technologies may change this
behavior.</p>
<p>If this is not set, we default to a merge window of 1000ms. To disable it, set the merge
window to 0.</p>
<p>Note: merging does not apply to cluster membership changes (e.g.: adds/removes); this is
because merging those updates isn’t currently safe. See
<a class="reference external" href="https://github.com/envoyproxy/envoy/pull/3941">https://github.com/envoyproxy/envoy/pull/3941</a>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-ignore-new-hosts-until-first-hc">
<dt>ignore_new_hosts_until_first_hc</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to true, Envoy will not consider new hosts when computing load balancing weights until
they have been health checked for the first time. This will have no effect unless
active health checking is also configured.</p>
<p>Ignoring a host means that for any load balancing calculations that adjust weights based
on the ratio of eligible hosts and total hosts (priority spillover, locality weighting and
panic mode) Envoy will exclude these hosts in the denominator.</p>
<p>For example, with hosts in two priorities P0 and P1, where P0 looks like
{healthy, unhealthy (new), unhealthy (new)}
and where P1 looks like
{healthy, healthy}
all traffic will still hit P0, as 1 / (3 - 2) = 1.</p>
<p>Enabling this will allow scaling up the number of hosts for a given cluster without entering
panic mode or triggering priority spillover, assuming the hosts pass the first health check.</p>
<p>If panic mode is triggered, new hosts are still eligible for traffic; they simply do not
contribute to the calculation when deciding whether panic mode is enabled or not.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-close-connections-on-host-set-change">
<dt>close_connections_on_host_set_change</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to <cite>true</cite>, the cluster manager will drain all existing
connections to upstream hosts whenever hosts are added or removed from the cluster.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-consistent-hashing-lb-config">
<dt>consistent_hashing_lb_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-consistenthashinglbconfig"><span class="std std-ref">config.cluster.v3.Cluster.CommonLbConfig.ConsistentHashingLbConfig</span></a>) ommon Configuration for all consistent hashing load balancers (MaglevLb, RingHashLb, etc.)</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig"></span><h2>config.cluster.v3.Cluster.CommonLbConfig.ZoneAwareLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L400">[config.cluster.v3.Cluster.CommonLbConfig.ZoneAwareLbConfig proto]</a></p>
<p>Configuration for <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/zone_aware.html#arch-overview-load-balancing-zone-aware-routing"><span class="std std-ref">zone aware routing</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;routing_enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;min_cluster_size&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;fail_traffic_on_panic&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig-routing-enabled">
<dt>routing_enabled</dt><dd><p>(<a class="reference internal" href="../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-percent"><span class="std std-ref">type.v3.Percent</span></a>) Configures percentage of requests that will be considered for zone aware routing
if zone aware routing is configured. If not specified, the default is 100%.
* <a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_runtime.html#config-cluster-manager-cluster-runtime-zone-routing"><span class="std std-ref">runtime values</span></a>.
* <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/zone_aware.html#arch-overview-load-balancing-zone-aware-routing"><span class="std std-ref">Zone aware routing support</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig-min-cluster-size">
<dt>min_cluster_size</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint64value">UInt64Value</a>) Configures minimum upstream cluster size required for zone aware routing
If upstream cluster size is less than specified, zone aware routing is not performed
even if zone aware routing is configured. If not specified, the default is 6.
* <a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_runtime.html#config-cluster-manager-cluster-runtime-zone-routing"><span class="std std-ref">runtime values</span></a>.
* <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/zone_aware.html#arch-overview-load-balancing-zone-aware-routing"><span class="std std-ref">Zone aware routing support</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-zoneawarelbconfig-fail-traffic-on-panic">
<dt>fail_traffic_on_panic</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to true, Envoy will not consider any hosts when the cluster is in <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/panic_threshold.html#arch-overview-load-balancing-panic-threshold"><span class="std std-ref">panic
mode</span></a>. Instead, the cluster will fail all
requests as if all hosts are unhealthy. This can help avoid potentially overwhelming a
failing service.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-commonlbconfig-localityweightedlbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-localityweightedlbconfig"></span><h2>config.cluster.v3.Cluster.CommonLbConfig.LocalityWeightedLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-commonlbconfig-localityweightedlbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L426">[config.cluster.v3.Cluster.CommonLbConfig.LocalityWeightedLbConfig proto]</a></p>
<p>Configuration for <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/locality_weight.html#arch-overview-load-balancing-locality-weighted-lb"><span class="std std-ref">locality weighted load balancing</span></a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-cluster-v3-cluster-commonlbconfig-consistenthashinglbconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-commonlbconfig-consistenthashinglbconfig"></span><h2>config.cluster.v3.Cluster.CommonLbConfig.ConsistentHashingLbConfig<a class="headerlink" href="#config-cluster-v3-cluster-commonlbconfig-consistenthashinglbconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L432">[config.cluster.v3.Cluster.CommonLbConfig.ConsistentHashingLbConfig proto]</a></p>
<p>Common Configuration for all consistent hashing load balancers (MaglevLb, RingHashLb, etc.)</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;use_hostname_for_hashing&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-consistenthashinglbconfig-use-hostname-for-hashing">
<dt>use_hostname_for_hashing</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to <cite>true</cite>, the cluster will use hostname instead of the resolved
address as the key to consistently hash to an upstream host. Only valid for StrictDNS clusters with hostnames which resolve to a single IP address.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-cluster-refreshrate">
<span id="envoy-v3-api-msg-config-cluster-v3-cluster-refreshrate"></span><h2>config.cluster.v3.Cluster.RefreshRate<a class="headerlink" href="#config-cluster-v3-cluster-refreshrate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L500">[config.cluster.v3.Cluster.RefreshRate proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;base_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-refreshrate-base-interval">
<dt>base_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>, <em>REQUIRED</em>) Specifies the base interval between refreshes. This parameter is required and must be greater
than zero and less than
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-refreshrate-max-interval"><span class="std std-ref">max_interval</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-cluster-refreshrate-max-interval">
<dt>max_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the maximum interval between refreshes. This parameter is optional, but must be
greater than or equal to the
<a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-refreshrate-base-interval"><span class="std std-ref">base_interval</span></a>  if set. The default
is 10 times the <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-refreshrate-base-interval"><span class="std std-ref">base_interval</span></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-discoverytype">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-discoverytype"></span><h2>Enum config.cluster.v3.Cluster.DiscoveryType<a class="headerlink" href="#enum-config-cluster-v3-cluster-discoverytype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L51">[config.cluster.v3.Cluster.DiscoveryType proto]</a></p>
<p>Refer to <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types"><span class="std std-ref">service discovery type</span></a>
for an explanation on each type.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-static">
<dt>STATIC</dt><dd><p><em>(DEFAULT)</em> ⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types-static"><span class="std std-ref">static discovery type</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns">
<dt>STRICT_DNS</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types-strict-dns"><span class="std std-ref">strict DNS discovery
type</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns">
<dt>LOGICAL_DNS</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types-logical-dns"><span class="std std-ref">logical DNS discovery
type</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-eds">
<dt>EDS</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types-eds"><span class="std std-ref">service discovery type</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-original-dst">
<dt>ORIGINAL_DST</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/service_discovery.html#arch-overview-service-discovery-types-original-destination"><span class="std std-ref">original destination discovery
type</span></a>
for an explanation.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-lbpolicy">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-lbpolicy"></span><h2>Enum config.cluster.v3.Cluster.LbPolicy<a class="headerlink" href="#enum-config-cluster-v3-cluster-lbpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L78">[config.cluster.v3.Cluster.LbPolicy proto]</a></p>
<p>Refer to <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types"><span class="std std-ref">load balancer type</span></a> architecture
overview section for information on each type.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-round-robin">
<dt>ROUND_ROBIN</dt><dd><p><em>(DEFAULT)</em> ⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-round-robin"><span class="std std-ref">round robin load balancing
policy</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-least-request">
<dt>LEAST_REQUEST</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-least-request"><span class="std std-ref">least request load balancing
policy</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-ring-hash">
<dt>RING_HASH</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-ring-hash"><span class="std std-ref">ring hash load balancing
policy</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-random">
<dt>RANDOM</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-random"><span class="std std-ref">random load balancing
policy</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-maglev">
<dt>MAGLEV</dt><dd><p>⁣Refer to the <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types-maglev"><span class="std std-ref">Maglev load balancing policy</span></a>
for an explanation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-lbpolicy-cluster-provided">
<dt>CLUSTER_PROVIDED</dt><dd><p>⁣This load balancer type must be specified if the configured cluster provides a cluster
specific load balancer. Consult the configured cluster’s documentation for whether to set
this option or not.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-dnslookupfamily">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-dnslookupfamily"></span><h2>Enum config.cluster.v3.Cluster.DnsLookupFamily<a class="headerlink" href="#enum-config-cluster-v3-cluster-dnslookupfamily" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L130">[config.cluster.v3.Cluster.DnsLookupFamily proto]</a></p>
<p>When V4_ONLY is selected, the DNS resolver will only perform a lookup for
addresses in the IPv4 family. If V6_ONLY is selected, the DNS resolver will
only perform a lookup for addresses in the IPv6 family. If AUTO is
specified, the DNS resolver will first perform a lookup for addresses in
the IPv6 family and fallback to a lookup for addresses in the IPv4 family.
For cluster types other than
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-strict-dns"><span class="std std-ref">STRICT_DNS</span></a> and
<a class="reference internal" href="#envoy-v3-api-enum-value-config-cluster-v3-cluster-discoverytype-logical-dns"><span class="std std-ref">LOGICAL_DNS</span></a>,
this setting is
ignored.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-dnslookupfamily-auto">
<dt>AUTO</dt><dd><p><em>(DEFAULT)</em> ⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-dnslookupfamily-v4-only">
<dt>V4_ONLY</dt><dd><p>⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-dnslookupfamily-v6-only">
<dt>V6_ONLY</dt><dd><p>⁣</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-cluster-v3-cluster-clusterprotocolselection">
<span id="envoy-v3-api-enum-config-cluster-v3-cluster-clusterprotocolselection"></span><h2>Enum config.cluster.v3.Cluster.ClusterProtocolSelection<a class="headerlink" href="#enum-config-cluster-v3-cluster-clusterprotocolselection" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L136">[config.cluster.v3.Cluster.ClusterProtocolSelection proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-clusterprotocolselection-use-configured-protocol">
<dt>USE_CONFIGURED_PROTOCOL</dt><dd><p><em>(DEFAULT)</em> ⁣Cluster can only operate on one of the possible upstream protocols (HTTP1.1, HTTP2).
If <a class="reference internal" href="#envoy-v3-api-field-config-cluster-v3-cluster-http2-protocol-options"><span class="std std-ref">http2_protocol_options</span></a> are
present, HTTP2 will be used, otherwise HTTP1.1 will be used.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-cluster-v3-cluster-clusterprotocolselection-use-downstream-protocol">
<dt>USE_DOWNSTREAM_PROTOCOL</dt><dd><p>⁣Use HTTP1.1 or HTTP2, depending on which one is used on the downstream connection.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-upstreambindconfig">
<span id="envoy-v3-api-msg-config-cluster-v3-upstreambindconfig"></span><h2>config.cluster.v3.UpstreamBindConfig<a class="headerlink" href="#config-cluster-v3-upstreambindconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L899">[config.cluster.v3.UpstreamBindConfig proto]</a></p>
<p>An extensible structure containing the address Envoy should bind to when
establishing upstream connections.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;source_address&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-upstreambindconfig-source-address">
<dt>source_address</dt><dd><p>(<a class="reference internal" href="../../core/v3/address.proto.html#envoy-v3-api-msg-config-core-v3-address"><span class="std std-ref">config.core.v3.Address</span></a>) The address Envoy should bind to when establishing upstream connections.</p>
</dd>
</dl>
</div>
<div class="section" id="config-cluster-v3-upstreamconnectionoptions">
<span id="envoy-v3-api-msg-config-cluster-v3-upstreamconnectionoptions"></span><h2>config.cluster.v3.UpstreamConnectionOptions<a class="headerlink" href="#config-cluster-v3-upstreamconnectionoptions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/07bf5b5c48da92c4474d1ffd73ecedbc1b4ed0c3/api/envoy/config/cluster/v3/cluster.proto#L906">[config.cluster.v3.UpstreamConnectionOptions proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;tcp_keepalive&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-cluster-v3-upstreamconnectionoptions-tcp-keepalive">
<dt>tcp_keepalive</dt><dd><p>(<a class="reference internal" href="../../core/v3/address.proto.html#envoy-v3-api-msg-config-core-v3-tcpkeepalive"><span class="std std-ref">config.core.v3.TcpKeepalive</span></a>) If set then set SO_KEEPALIVE on the socket to enable TCP Keepalives.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="outlier_detection.proto.html" class="btn btn-neutral float-right" title="Outlier detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../../clusters/clusters.html" class="btn btn-neutral float-left" title="Clusters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020, Envoy Project Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>