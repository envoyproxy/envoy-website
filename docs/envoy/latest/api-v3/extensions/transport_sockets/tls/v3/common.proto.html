

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Common TLS configuration &mdash; envoy 1.17.0-dev-95b7ef documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Secrets configuration" href="secret.proto.html" />
    <link rel="prev" title="envoy/extensions/transport_sockets/tls/v3/cert.proto" href="cert.proto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-dev-95b7ef
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../api.html">v3 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../../config/config.html">Extensions</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../../config/filter/filter.html">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/accesslog/accesslog.html">Access loggers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/rbac/rbac.html">RBAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/health_checker/health_checker.html">Health checkers</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../../../config/transport_socket/transport_socket.html">Transport sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/resource_monitor/resource_monitor.html">Resource monitors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/common/common.html">Common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/compression/compression.html">Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/cluster/cluster.html">Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/grpc_credential/grpc_credential.html">Grpc Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/retry/retry.html">Retry Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/trace/trace.html">HTTP Tracers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/internal_redirect/internal_redirect.html">Internal Redirect Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/endpoint/endpoint.html">Endpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/upstream/upstream.html">Upstream Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/wasm/wasm.html">WASM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../config/watchdog/watchdog.html">Watchdog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../../api/api.html">API</a> &raquo;</li>
        
          <li><a href="../../../../api.html">v3 API reference</a> &raquo;</li>
        
          <li><a href="../../../../config/config.html">Extensions</a> &raquo;</li>
        
          <li><a href="../../../../config/transport_socket/transport_socket.html">Transport sockets</a> &raquo;</li>
        
      <li>Common TLS configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/api-v3/extensions/transport_sockets/tls/v3/common.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="common-tls-configuration">
<span id="envoy-v3-api-file-envoy-extensions-transport-sockets-tls-v3-common-proto"></span><h1>Common TLS configuration<a class="headerlink" href="#common-tls-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="extensions-transport-sockets-tls-v3-tlsparameters">
<span id="envoy-v3-api-msg-extensions-transport-sockets-tls-v3-tlsparameters"></span><h2>extensions.transport_sockets.tls.v3.TlsParameters<a class="headerlink" href="#extensions-transport-sockets-tls-v3-tlsparameters" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L23">[extensions.transport_sockets.tls.v3.TlsParameters proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;tls_minimum_protocol_version&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;tls_maximum_protocol_version&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cipher_suites&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;ecdh_curves&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-tls-minimum-protocol-version">
<dt>tls_minimum_protocol_version</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol"><span class="std std-ref">extensions.transport_sockets.tls.v3.TlsParameters.TlsProtocol</span></a>) Minimum TLS protocol version. By default, it’s <code class="docutils literal notranslate"><span class="pre">TLSv1_2</span></code> for clients and <code class="docutils literal notranslate"><span class="pre">TLSv1_0</span></code> for
servers.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-tls-maximum-protocol-version">
<dt>tls_maximum_protocol_version</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol"><span class="std std-ref">extensions.transport_sockets.tls.v3.TlsParameters.TlsProtocol</span></a>) Maximum TLS protocol version. By default, it’s <code class="docutils literal notranslate"><span class="pre">TLSv1_2</span></code> for clients and <code class="docutils literal notranslate"><span class="pre">TLSv1_3</span></code> for
servers.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-cipher-suites">
<dt>cipher_suites</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, the TLS listener will only support the specified <a class="reference external" href="https://commondatastorage.googleapis.com/chromium-boringssl-docs/ssl.h.html#Cipher-suite-configuration">cipher list</a>
when negotiating TLS 1.0-1.2 (this setting has no effect when negotiating TLS 1.3). If not
specified, the default list will be used.</p>
<p>In non-FIPS builds, the default cipher list is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-CHACHA20-POLY1305]
[ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-CHACHA20-POLY1305]
ECDHE-ECDSA-AES128-SHA
ECDHE-RSA-AES128-SHA
AES128-GCM-SHA256
AES128-SHA
ECDHE-ECDSA-AES256-GCM-SHA384
ECDHE-RSA-AES256-GCM-SHA384
ECDHE-ECDSA-AES256-SHA
ECDHE-RSA-AES256-SHA
AES256-GCM-SHA384
AES256-SHA
</pre></div>
</div>
<p>In builds using <a class="reference internal" href="../../../../../intro/arch_overview/security/ssl.html#arch-overview-ssl-fips"><span class="std std-ref">BoringSSL FIPS</span></a>, the default cipher list is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ECDHE-ECDSA-AES128-GCM-SHA256
ECDHE-RSA-AES128-GCM-SHA256
ECDHE-ECDSA-AES128-SHA
ECDHE-RSA-AES128-SHA
AES128-GCM-SHA256
AES128-SHA
ECDHE-ECDSA-AES256-GCM-SHA384
ECDHE-RSA-AES256-GCM-SHA384
ECDHE-ECDSA-AES256-SHA
ECDHE-RSA-AES256-SHA
AES256-GCM-SHA384
AES256-SHA
</pre></div>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-ecdh-curves">
<dt>ecdh_curves</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, the TLS connection will only support the specified ECDH
curves. If not specified, the default curves will be used.</p>
<p>In non-FIPS builds, the default curves are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X25519
P-256
</pre></div>
</div>
<p>In builds using <a class="reference internal" href="../../../../../intro/arch_overview/security/ssl.html#arch-overview-ssl-fips"><span class="std std-ref">BoringSSL FIPS</span></a>, the default curve is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>P-256
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol">
<span id="envoy-v3-api-enum-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol"></span><h2>Enum extensions.transport_sockets.tls.v3.TlsParameters.TlsProtocol<a class="headerlink" href="#enum-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L26">[extensions.transport_sockets.tls.v3.TlsParameters.TlsProtocol proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol-tls-auto">
<dt>TLS_AUTO</dt><dd><p><em>(DEFAULT)</em> ⁣Envoy will choose the optimal TLS version.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol-tlsv1-0">
<dt>TLSv1_0</dt><dd><p>⁣TLS 1.0</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol-tlsv1-1">
<dt>TLSv1_1</dt><dd><p>⁣TLS 1.1</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol-tlsv1-2">
<dt>TLSv1_2</dt><dd><p>⁣TLS 1.2</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-tlsparameters-tlsprotocol-tlsv1-3">
<dt>TLSv1_3</dt><dd><p>⁣TLS 1.3</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-transport-sockets-tls-v3-privatekeyprovider">
<span id="envoy-v3-api-msg-extensions-transport-sockets-tls-v3-privatekeyprovider"></span><h2>extensions.transport_sockets.tls.v3.PrivateKeyProvider<a class="headerlink" href="#extensions-transport-sockets-tls-v3-privatekeyprovider" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L112">[extensions.transport_sockets.tls.v3.PrivateKeyProvider proto]</a></p>
<p>BoringSSL private key method configuration. The private key methods are used for external
(potentially asynchronous) signing and decryption operations. Some use cases for private key
methods would be TPM support and TLS acceleration.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;provider_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-privatekeyprovider-provider-name">
<dt>provider_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Private key method provider name. The name must match a
supported private key method provider type.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-privatekeyprovider-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>)
Private key method provider specific configuration.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-transport-sockets-tls-v3-tlscertificate">
<span id="envoy-v3-api-msg-extensions-transport-sockets-tls-v3-tlscertificate"></span><h2>extensions.transport_sockets.tls.v3.TlsCertificate<a class="headerlink" href="#extensions-transport-sockets-tls-v3-tlscertificate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L131">[extensions.transport_sockets.tls.v3.TlsCertificate proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;certificate_chain&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;private_key&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;watched_directory&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;private_key_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ocsp_staple&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-certificate-chain">
<dt>certificate_chain</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) The TLS certificate chain.</p>
<p>If <em>certificate_chain</em> is a filesystem path, a watch will be added to the
parent directory for any file moves to support rotation. This currently
only applies to dynamic secrets, when the <em>TlsCertificate</em> is delivered via
SDS.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-private-key">
<dt>private_key</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) The TLS private key.</p>
<p>If <em>private_key</em> is a filesystem path, a watch will be added to the parent
directory for any file moves to support rotation. This currently only
applies to dynamic secrets, when the <em>TlsCertificate</em> is delivered via SDS.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-watched-directory">
<dt>watched_directory</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-watcheddirectory"><span class="std std-ref">config.core.v3.WatchedDirectory</span></a>) If specified, updates of file-based <em>certificate_chain</em> and <em>private_key</em>
sources will be triggered by this watch. The certificate/key pair will be
read together and validated for atomic read consistency (i.e. no
intervening modification occurred between cert/key read, verified by file
hash comparisons). This allows explicit control over the path watched, by
default the parent directories of the filesystem paths in
<em>certificate_chain</em> and <em>private_key</em> are watched if this field is not
specified. This only applies when a <em>TlsCertificate</em> is delivered by SDS
with references to filesystem paths. See the <a class="reference internal" href="../../../../../configuration/security/secret.html#sds-key-rotation"><span class="std std-ref">SDS key rotation</span></a> documentation for further details.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-private-key-provider">
<dt>private_key_provider</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-transport-sockets-tls-v3-privatekeyprovider"><span class="std std-ref">extensions.transport_sockets.tls.v3.PrivateKeyProvider</span></a>) BoringSSL private key method provider. This is an alternative to <a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-private-key"><span class="std std-ref">private_key</span></a> field. This can’t be
marked as <code class="docutils literal notranslate"><span class="pre">oneof</span></code> due to API compatibility reasons. Setting both <a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-private-key"><span class="std std-ref">private_key</span></a> and
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-private-key-provider"><span class="std std-ref">private_key_provider</span></a> fields will result in an
error.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-password">
<dt>password</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) The password to decrypt the TLS private key. If this field is not set, it is assumed that the
TLS private key is not password encrypted.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-ocsp-staple">
<dt>ocsp_staple</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) The OCSP response to be stapled with this certificate during the handshake.
The response must be DER-encoded and may only be  provided via <code class="docutils literal notranslate"><span class="pre">filename</span></code> or
<code class="docutils literal notranslate"><span class="pre">inline_bytes</span></code>. The response may pertain to only one certificate.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-transport-sockets-tls-v3-tlssessionticketkeys">
<span id="envoy-v3-api-msg-extensions-transport-sockets-tls-v3-tlssessionticketkeys"></span><h2>extensions.transport_sockets.tls.v3.TlsSessionTicketKeys<a class="headerlink" href="#extensions-transport-sockets-tls-v3-tlssessionticketkeys" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L183">[extensions.transport_sockets.tls.v3.TlsSessionTicketKeys proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;keys&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlssessionticketkeys-keys">
<dt>keys</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>, <em>REQUIRED</em>) Keys for encrypting and decrypting TLS session tickets. The
first key in the array contains the key to encrypt all new sessions created by this context.
All keys are candidates for decrypting received tickets. This allows for easy rotation of keys
by, for example, putting the new key first, and the previous key second.</p>
<p>If <a class="reference internal" href="tls.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-downstreamtlscontext-session-ticket-keys"><span class="std std-ref">session_ticket_keys</span></a>
is not specified, the TLS library will still support resuming sessions via tickets, but it will
use an internally-generated and managed key, so sessions cannot be resumed across hot restarts
or on different hosts.</p>
<p>Each key must contain exactly 80 bytes of cryptographically-secure random data. For
example, the output of <code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">rand</span> <span class="pre">80</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Using this feature has serious security considerations and risks. Improper handling of keys
may result in loss of secrecy in connections, even if ciphers supporting perfect forward
secrecy are used. See <a class="reference external" href="https://www.imperialviolet.org/2013/06/27/botchingpfs.html">https://www.imperialviolet.org/2013/06/27/botchingpfs.html</a> for some
discussion. To minimize the risk, you must:</p>
<ul class="simple">
<li><p>Keep the session ticket keys at least as secure as your TLS certificate private keys</p></li>
<li><p>Rotate session ticket keys at least daily, and preferably hourly</p></li>
<li><p>Always generate keys using a cryptographically-secure random data source</p></li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="section" id="extensions-transport-sockets-tls-v3-certificatevalidationcontext">
<span id="envoy-v3-api-msg-extensions-transport-sockets-tls-v3-certificatevalidationcontext"></span><h2>extensions.transport_sockets.tls.v3.CertificateValidationContext<a class="headerlink" href="#extensions-transport-sockets-tls-v3-certificatevalidationcontext" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L215">[extensions.transport_sockets.tls.v3.CertificateValidationContext proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;trusted_ca&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;watched_directory&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;verify_certificate_spki&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;verify_certificate_hash&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;match_subject_alt_names&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;crl&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;allow_expired_certificate&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;trust_chain_verification&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trusted-ca">
<dt>trusted_ca</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) TLS certificate data containing certificate authority certificates to use in verifying
a presented peer certificate (e.g. server certificate for clusters or client certificate
for listeners). If not specified and a peer certificate is presented it will not be
verified. By default, a client certificate is optional, unless one of the additional
options (<a class="reference internal" href="tls.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-downstreamtlscontext-require-client-certificate"><span class="std std-ref">require_client_certificate</span></a>,
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-spki"><span class="std std-ref">verify_certificate_spki</span></a>,
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-hash"><span class="std std-ref">verify_certificate_hash</span></a>, or
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-match-subject-alt-names"><span class="std std-ref">match_subject_alt_names</span></a>) is also
specified.</p>
<p>It can optionally contain certificate revocation lists, in which case Envoy will verify
that the presented peer certificate has not been revoked by one of the included CRLs. Note
that if a CRL is provided for any certificate authority in a trust chain, a CRL must be
provided for all certificate authorities in that chain. Failure to do so will result in
verification failure for both revoked and unrevoked certificates from that chain.</p>
<p>See <a class="reference internal" href="../../../../../intro/arch_overview/security/ssl.html#arch-overview-ssl-enabling-verification"><span class="std std-ref">the TLS overview</span></a> for a list of common
system CA locations.</p>
<p>If <em>trusted_ca</em> is a filesystem path, a watch will be added to the parent
directory for any file moves to support rotation. This currently only
applies to dynamic secrets, when the <em>CertificateValidationContext</em> is
delivered via SDS.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-watched-directory">
<dt>watched_directory</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-watcheddirectory"><span class="std std-ref">config.core.v3.WatchedDirectory</span></a>) If specified, updates of a file-based <em>trusted_ca</em> source will be triggered
by this watch. This allows explicit control over the path watched, by
default the parent directory of the filesystem path in <em>trusted_ca</em> is
watched if this field is not specified. This only applies when a
<em>CertificateValidationContext</em> is delivered by SDS with references to
filesystem paths. See the <a class="reference internal" href="../../../../../configuration/security/secret.html#sds-key-rotation"><span class="std std-ref">SDS key rotation</span></a>
documentation for further details.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-spki">
<dt>verify_certificate_spki</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional list of base64-encoded SHA-256 hashes. If specified, Envoy will verify that the
SHA-256 of the DER-encoded Subject Public Key Information (SPKI) of the presented certificate
matches one of the specified values.</p>
<p>A base64-encoded SHA-256 of the Subject Public Key Information (SPKI) of the certificate
can be generated with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openssl x509 -in path/to/client.crt -noout -pubkey
  <span class="p">|</span> openssl pkey -pubin -outform DER
  <span class="p">|</span> openssl dgst -sha256 -binary
  <span class="p">|</span> openssl enc -base64
NvqYIYSbgK2vCJpQhObf77vv+bQWtc5ek5RIOwPiC9A<span class="o">=</span>
</pre></div>
</div>
<p>This is the format used in HTTP Public Key Pinning.</p>
<p>When both:
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-hash"><span class="std std-ref">verify_certificate_hash</span></a> and
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-spki"><span class="std std-ref">verify_certificate_spki</span></a> are specified,
a hash matching value from either of the lists will result in the certificate being accepted.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This option is preferred over <a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-hash"><span class="std std-ref">verify_certificate_hash</span></a>,
because SPKI is tied to a private key, so it doesn’t change when the certificate
is renewed using the same private key.</p>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-hash">
<dt>verify_certificate_hash</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional list of hex-encoded SHA-256 hashes. If specified, Envoy will verify that
the SHA-256 of the DER-encoded presented certificate matches one of the specified values.</p>
<p>A hex-encoded SHA-256 of the certificate can be generated with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openssl x509 -in path/to/client.crt -outform DER <span class="p">|</span> openssl dgst -sha256 <span class="p">|</span> cut -d<span class="s2">&quot; &quot;</span> -f2
df6ff72fe9116521268f6f2dd4966f51df479883fe7037b39f75916ac3049d1a
</pre></div>
</div>
<p>A long hex-encoded and colon-separated SHA-256 (a.k.a. “fingerprint”) of the certificate
can be generated with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openssl x509 -in path/to/client.crt -noout -fingerprint -sha256 <span class="p">|</span> cut -d<span class="s2">&quot;=&quot;</span> -f2
DF:6F:F7:2F:E9:11:65:21:26:8F:6F:2D:D4:96:6F:51:DF:47:98:83:FE:70:37:B3:9F:75:91:6A:C3:04:9D:1A
</pre></div>
</div>
<p>Both of those formats are acceptable.</p>
<p>When both:
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-hash"><span class="std std-ref">verify_certificate_hash</span></a> and
<a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-verify-certificate-spki"><span class="std std-ref">verify_certificate_spki</span></a> are specified,
a hash matching value from either of the lists will result in the certificate being accepted.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-match-subject-alt-names">
<dt>match_subject_alt_names</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../type/matcher/v3/string.proto.html#envoy-v3-api-msg-type-matcher-v3-stringmatcher"><span class="std std-ref">type.matcher.v3.StringMatcher</span></a>) An optional list of Subject Alternative name matchers. If specified, Envoy will verify that the
Subject Alternative Name of the presented certificate matches one of the specified matchers.</p>
<p>When a certificate has wildcard DNS SAN entries, to match a specific client, it should be
configured with exact match type in the <a class="reference internal" href="../../../../type/matcher/v3/string.proto.html#envoy-v3-api-msg-type-matcher-v3-stringmatcher"><span class="std std-ref">string matcher</span></a>.
For example if the certificate has “*.example.com” as DNS SAN entry, to allow only “api.example.com”,
it should be configured as shown below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">match_subject_alt_names</span><span class="p">:</span>
  <span class="nt">exact</span><span class="p">:</span> <span class="s">&quot;api.example.com&quot;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Subject Alternative Names are easily spoofable and verifying only them is insecure,
therefore this option must be used together with <a class="reference internal" href="#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trusted-ca"><span class="std std-ref">trusted_ca</span></a>.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-crl">
<dt>crl</dt><dd><p>(<a class="reference internal" href="../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) An optional <a class="reference external" href="https://en.wikipedia.org/wiki/Certificate_revocation_list">certificate revocation list</a>
(in PEM format). If specified, Envoy will verify that the presented peer
certificate has not been revoked by this CRL. If this DataSource contains
multiple CRLs, all of them will be used. Note that if a CRL is provided
for any certificate authority in a trust chain, a CRL must be provided
for all certificate authorities in that chain. Failure to do so will
result in verification failure for both revoked and unrevoked certificates
from that chain.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-allow-expired-certificate">
<dt>allow_expired_certificate</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If specified, Envoy will not reject expired certificates.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trust-chain-verification">
<dt>trust_chain_verification</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification"><span class="std std-ref">extensions.transport_sockets.tls.v3.CertificateValidationContext.TrustChainVerification</span></a>) Certificate trust chain verification mode.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification">
<span id="envoy-v3-api-enum-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification"></span><h2>Enum extensions.transport_sockets.tls.v3.CertificateValidationContext.TrustChainVerification<a class="headerlink" href="#enum-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/95b7ef27eeda0bde0858257925a8c262baa6b3a2/api/envoy/extensions/transport_sockets/tls/v3/common.proto#L220">[extensions.transport_sockets.tls.v3.CertificateValidationContext.TrustChainVerification proto]</a></p>
<p>Peer certificate verification mode.</p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification-verify-trust-chain">
<dt>VERIFY_TRUST_CHAIN</dt><dd><p><em>(DEFAULT)</em> ⁣Perform default certificate verification (e.g., against CA / verification lists)</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-transport-sockets-tls-v3-certificatevalidationcontext-trustchainverification-accept-untrusted">
<dt>ACCEPT_UNTRUSTED</dt><dd><p>⁣Connections where the certificate fails verification will be permitted.
For HTTP connections, the result of certificate verification can be used in route matching. (
see <a class="reference internal" href="../../../../config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routematch-tlscontextmatchoptions-validated"><span class="std std-ref">validated</span></a> ).</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="secret.proto.html" class="btn btn-neutral float-right" title="Secrets configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cert.proto.html" class="btn btn-neutral float-left" title="envoy/extensions/transport_sockets/tls/v3/cert.proto" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2020, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>