

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>JWT Authentication &mdash; envoy 1.17.0-dev-8b1569 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="Tap" href="../../tap/v2alpha/tap.proto.html" />
    <link rel="prev" title="gRPC statistics" href="../../grpc_stats/v2alpha/config.proto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html">
          

          
            
            <img src="../../../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-dev-8b1569
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../../api.html">v2 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../../config.html">Extensions</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../../filter.html">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../accesslog/accesslog.html">Access loggers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../rbac/rbac.html">RBAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../health_checker/health_checker.html">Health checkers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../transport_socket/transport_socket.html">Transport sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../resource_monitor/resource_monitor.html">Resource monitors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../common/common.html">Common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../cluster/cluster.html">Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../listener/listener.html">Listener</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../grpc_credential/grpc_credential.html">Grpc Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../retry/retry.html">Retry Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../trace/trace.html">HTTP Tracers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api-v3/api.html">v3 API reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../../../api/api.html">API</a> &raquo;</li>
        
          <li><a href="../../../../../api.html">v2 API reference</a> &raquo;</li>
        
          <li><a href="../../../../config.html">Extensions</a> &raquo;</li>
        
          <li><a href="../../../filter.html">Filters</a> &raquo;</li>
        
          <li><a href="../../http.html">HTTP filters</a> &raquo;</li>
        
      <li>JWT Authentication</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/api-v2/config/filter/http/jwt_authn/v2alpha/config.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="jwt-authentication">
<span id="envoy-api-file-envoy-config-filter-http-jwt-authn-v2alpha-config-proto"></span><h1>JWT Authentication<a class="headerlink" href="#jwt-authentication" title="Permalink to this headline">¶</a></h1>
<p id="extension-envoy-filters-http-jwt-authn">This extension may be referenced by the qualified name <em>envoy.filters.http.jwt_authn</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This extension is functional but has not had substantial production burn time, use only with this caveat.</p>
<p>This extension is intended to be robust against untrusted downstream traffic. It assumes that the upstream is trusted.</p>
</div>
<p>JWT Authentication <a class="reference internal" href="../../../../../../configuration/http/http_filters/jwt_authn_filter.html#config-http-filters-jwt-authn"><span class="std std-ref">configuration overview</span></a>.</p>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtprovider">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtprovider"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtProvider<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtprovider" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L56">[config.filter.http.jwt_authn.v2alpha.JwtProvider proto]</a></p>
<p>Please see following for JWT authentication flow:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a></p></li>
<li><p><a class="reference external" href="http://openid.net/connect">OpenID Connect</a></p></li>
</ul>
<p>A JwtProvider message specifies how a JSON Web Token (JWT) can be verified. It specifies:</p>
<ul class="simple">
<li><p>issuer: the principal that issues the JWT. It has to match the one from the token.</p></li>
<li><p>allowed audiences: the ones in the token have to be listed here.</p></li>
<li><p>how to fetch public key JWKS to verify the token signature.</p></li>
<li><p>how to extract JWT token in the request.</p></li>
<li><p>how to pass successfully verified token payload.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com</span>
<span class="nt">audiences</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_android.apps.googleusercontent.com</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_web.apps.googleusercontent.com</span>
<span class="nt">remote_jwks</span><span class="p">:</span>
  <span class="nt">http_uri</span><span class="p">:</span>
    <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com/.well-known/jwks.json</span>
    <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
  <span class="nt">cache_duration</span><span class="p">:</span>
    <span class="nt">seconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;issuer&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;audiences&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;remote_jwks&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;local_jwks&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;forward&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;from_headers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;from_params&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;forward_payload_header&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;payload_in_metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-issuer">
<dt>issuer</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Specify the <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.1">principal</a> that issued
the JWT, usually a URL or an email address.</p>
<p>Example: <a class="reference external" href="https://securetoken.google.com">https://securetoken.google.com</a>
Example: <a class="reference external" href="mailto:1234567-compute&#37;&#52;&#48;developer&#46;gserviceaccount&#46;com">1234567-compute<span>&#64;</span>developer<span>&#46;</span>gserviceaccount<span>&#46;</span>com</a></p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-audiences">
<dt>audiences</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The list of JWT <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.3">audiences</a> are
allowed to access. A JWT containing any of these audiences will be accepted. If not specified,
will not check audiences in the token.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">audiences</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_android.apps.googleusercontent.com</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_web.apps.googleusercontent.com</span>
</pre></div>
</div>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-remote-jwks">
<dt>remote_jwks</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-remotejwks"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.RemoteJwks</span></a>) JWKS can be fetched from remote server via HTTP/HTTPS. This field specifies the remote HTTP
URI and how the fetched JWKS should be cached.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">remote_jwks</span><span class="p">:</span>
  <span class="nt">http_uri</span><span class="p">:</span>
    <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.googleapis.com/oauth2/v1/certs</span>
    <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt.www.googleapis.com|443</span>
  <span class="nt">cache_duration</span><span class="p">:</span>
    <span class="nt">seconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
</pre></div>
</div>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc7517#appendix-A">JSON Web Key Set (JWKS)</a> is needed to
validate signature of a JWT. This field specifies where to fetch JWKS.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-remote-jwks"><span class="std std-ref">remote_jwks</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-local-jwks"><span class="std std-ref">local_jwks</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-local-jwks">
<dt>local_jwks</dt><dd><p>(<a class="reference internal" href="../../../../../api/v2/core/base.proto.html#envoy-api-msg-core-datasource"><span class="std std-ref">core.DataSource</span></a>) JWKS is in local data source. It could be either in a local file or embedded in the
inline_string.</p>
<p>Example: local file</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">local_jwks</span><span class="p">:</span>
  <span class="nt">filename</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/envoy/jwks/jwks1.txt</span>
</pre></div>
</div>
<p>Example: inline_string</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">local_jwks</span><span class="p">:</span>
  <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ACADADADADA</span>
</pre></div>
</div>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc7517#appendix-A">JSON Web Key Set (JWKS)</a> is needed to
validate signature of a JWT. This field specifies where to fetch JWKS.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-remote-jwks"><span class="std std-ref">remote_jwks</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-local-jwks"><span class="std std-ref">local_jwks</span></a> must be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-forward">
<dt>forward</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If false, the JWT is removed in the request after a success verification. If true, the JWT is
not removed in the request. Default value is false.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-from-headers">
<dt>from_headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtheader"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtHeader</span></a>) Two fields below define where to extract the JWT from an HTTP request.</p>
<p>If no explicit location is specified, the following default locations are tried in order:</p>
<p>1. The Authorization header using the <a class="reference external" href="https://tools.ietf.org/html/rfc6750#section-2.1">Bearer schema</a>. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="o">&lt;</span><span class="n">token</span><span class="o">&gt;.</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc6750#section-2.3">access_token</a> query parameter.</p></li>
</ol>
<p>Multiple JWTs can be verified for a request. Each JWT has to be extracted from the locations
its provider specified or from the default locations.</p>
<p>Specify the HTTP headers to extract JWT token. For examples, following config:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">from_headers</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-goog-iap-jwt-assertion</span>
</pre></div>
</div>
<p>can be used to extract token from header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>``x-goog-iap-jwt-assertion: &lt;JWT&gt;``.
</pre></div>
</div>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-from-params">
<dt>from_params</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) JWT is sent in a query parameter. <cite>jwt_params</cite> represents the query parameter names.</p>
<p>For example, if config is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">from_params</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jwt_token</span>
</pre></div>
</div>
<p>The JWT format in query parameter is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/path?jwt_token=&lt;JWT&gt;
</pre></div>
</div>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-forward-payload-header">
<dt>forward_payload_header</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) This field specifies the header name to forward a successfully verified JWT payload to the
backend. The forwarded data is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base64url_encoded</span><span class="p">(</span><span class="n">jwt_payload_in_JSON</span><span class="p">)</span>
</pre></div>
</div>
<p>If it is not specified, the payload will not be forwarded.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtprovider-payload-in-metadata">
<dt>payload_in_metadata</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If non empty, successfully verified JWT payloads will be written to StreamInfo DynamicMetadata
in the format as: <em>namespace</em> is the jwt_authn filter name as <strong>envoy.filters.http.jwt_authn</strong>
The value is the <em>protobuf::Struct</em>. The value of this field will be the key for its <em>fields</em>
and the value is the <em>protobuf::Struct</em> converted from JWT JSON payload.</p>
<p>For example, if payload_in_metadata is <em>my_payload</em>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">envoy.filters.http.jwt_authn</span><span class="p">:</span>
  <span class="nt">my_payload</span><span class="p">:</span>
    <span class="nt">iss</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com</span>
    <span class="nt">sub</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test@example.com</span>
    <span class="nt">aud</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com</span>
    <span class="nt">exp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1501281058</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-remotejwks">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-remotejwks"></span><h2>config.filter.http.jwt_authn.v2alpha.RemoteJwks<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-remotejwks" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L194">[config.filter.http.jwt_authn.v2alpha.RemoteJwks proto]</a></p>
<p>This message specifies how to fetch JWKS from remote and how to cache it.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;http_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cache_duration&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-remotejwks-http-uri">
<dt>http_uri</dt><dd><p>(<a class="reference internal" href="../../../../../api/v2/core/http_uri.proto.html#envoy-api-msg-core-httpuri"><span class="std std-ref">core.HttpUri</span></a>) The HTTP URI to fetch the JWKS. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">http_uri</span><span class="p">:</span>
  <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.googleapis.com/oauth2/v1/certs</span>
  <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt.www.googleapis.com|443</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-remotejwks-cache-duration">
<dt>cache_duration</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Duration after which the cached JWKS should be expired. If not specified, default cache
duration is 5 minutes.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtheader">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtheader"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtHeader<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtheader" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L211">[config.filter.http.jwt_authn.v2alpha.JwtHeader proto]</a></p>
<p>This message specifies a header location to extract JWT token.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;value_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtheader-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The HTTP header name.</p>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtheader-value-prefix">
<dt>value_prefix</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The value prefix. The value format is “value_prefix&lt;token&gt;”
For example, for “Authorization: Bearer &lt;token&gt;”, value_prefix=”Bearer ” with a space at the
end.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-providerwithaudiences">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-providerwithaudiences"></span><h2>config.filter.http.jwt_authn.v2alpha.ProviderWithAudiences<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-providerwithaudiences" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L222">[config.filter.http.jwt_authn.v2alpha.ProviderWithAudiences proto]</a></p>
<p>Specify a required provider with audiences.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;provider_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;audiences&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-providerwithaudiences-provider-name">
<dt>provider_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specify a required provider name.</p>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-providerwithaudiences-audiences">
<dt>audiences</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) This field overrides the one specified in the JwtProvider.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtrequirement">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirement"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtRequirement<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtrequirement" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L287">[config.filter.http.jwt_authn.v2alpha.JwtRequirement proto]</a></p>
<p>This message specifies a Jwt requirement. An empty message means JWT verification is not
required. Here are some config examples:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1: not required with an empty message</span>

<span class="c1"># Example 2: require A</span>
<span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>

<span class="c1"># Example 3: require A or B</span>
<span class="nt">requires_any</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-B</span>

<span class="c1"># Example 4: require A and B</span>
<span class="nt">requires_all</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-B</span>

<span class="c1"># Example 5: require A and (B or C)</span>
<span class="nt">requires_all</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
    <span class="p p-Indicator">-</span> <span class="nt">requires_any</span><span class="p">:</span>
      <span class="nt">requirements</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-B</span>
        <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-C</span>

<span class="c1"># Example 6: require A or (B and C)</span>
<span class="nt">requires_any</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
    <span class="p p-Indicator">-</span> <span class="nt">requires_all</span><span class="p">:</span>
      <span class="nt">requirements</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-B</span>
        <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-C</span>

<span class="c1"># Example 7: A is optional (if token from A is provided, it must be valid, but also allows</span>
<span class="l l-Scalar l-Scalar-Plain">missing token.)</span>
<span class="nt">requires_any</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
  <span class="p p-Indicator">-</span> <span class="nt">allow_missing</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

<span class="c1"># Example 8: A is optional and B is required.</span>
<span class="nt">requires_all</span><span class="p">:</span>
  <span class="nt">requirements</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">requires_any</span><span class="p">:</span>
      <span class="nt">requirements</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-A</span>
      <span class="p p-Indicator">-</span> <span class="nt">allow_missing</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider-B</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;provider_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;provider_and_audiences&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;requires_any&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;requires_all&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;allow_missing_or_failed&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;allow_missing&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name">
<dt>provider_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specify a required provider name.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences">
<dt>provider_and_audiences</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-providerwithaudiences"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.ProviderWithAudiences</span></a>) Specify a required provider with audiences.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any">
<dt>requires_any</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirementorlist"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirementOrList</span></a>) Specify list of JwtRequirement. Their results are OR-ed.
If any one of them passes, the result is passed.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all">
<dt>requires_all</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirementandlist"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirementAndList</span></a>) Specify list of JwtRequirement. Their results are AND-ed.
All of them must pass, if one of them fails or missing, it fails.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed">
<dt>allow_missing_or_failed</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#empty">Empty</a>) The requirement is always satisfied even if JWT is missing or the JWT
verification fails. A typical usage is: this filter is used to only verify
JWTs and pass the verified JWT payloads to another filter, the other filter
will make decision. In this mode, all JWT tokens will be verified.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing">
<dt>allow_missing</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#empty">Empty</a>) The requirement is satisfied if JWT is missing, but failed if JWT is
presented but invalid. Similar to allow_missing_or_failed, this is used
to only verify JWTs and pass the verified payload to another filter. The
different is this mode will reject requests with invalid tokens.</p>
<p>Only one of <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-name"><span class="std std-ref">provider_name</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-provider-and-audiences"><span class="std std-ref">provider_and_audiences</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-any"><span class="std std-ref">requires_any</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-requires-all"><span class="std std-ref">requires_all</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing-or-failed"><span class="std std-ref">allow_missing_or_failed</span></a>, <a class="reference internal" href="#envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirement-allow-missing"><span class="std std-ref">allow_missing</span></a> may be set.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtrequirementorlist">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirementorlist"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtRequirementOrList<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtrequirementorlist" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L319">[config.filter.http.jwt_authn.v2alpha.JwtRequirementOrList proto]</a></p>
<p>This message specifies a list of RequiredProvider.
Their results are OR-ed; if any one of them passes, the result is passed</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirementorlist-requirements">
<dt>requirements</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirement"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirement</span></a>, <em>REQUIRED</em>) Specify a list of JwtRequirement.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtrequirementandlist">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirementandlist"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtRequirementAndList<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtrequirementandlist" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L326">[config.filter.http.jwt_authn.v2alpha.JwtRequirementAndList proto]</a></p>
<p>This message specifies a list of RequiredProvider.
Their results are AND-ed; all of them must pass, if one of them fails or missing, it fails.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtrequirementandlist-requirements">
<dt>requirements</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirement"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirement</span></a>, <em>REQUIRED</em>) Specify a list of JwtRequirement.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-requirementrule">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-requirementrule"></span><h2>config.filter.http.jwt_authn.v2alpha.RequirementRule<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-requirementrule" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L352">[config.filter.http.jwt_authn.v2alpha.RequirementRule proto]</a></p>
<p>This message specifies a Jwt requirement for a specific Route condition.
Example 1:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/healthz</span>
</pre></div>
</div>
<p>In above example, “requires” field is empty for /healthz prefix match,
it means that requests matching the path prefix don’t require JWT authentication.</p>
<p>Example 2:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
  <span class="nt">requires</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> provider_name</span><span class="p">:</span> <span class="nv">provider-A</span> <span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>In above example, all requests matched the path prefix require jwt authentication
from “provider-A”.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;requires&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-requirementrule-match">
<dt>match</dt><dd><p>(<a class="reference internal" href="../../../../../api/v2/route/route_components.proto.html#envoy-api-msg-route-routematch"><span class="std std-ref">route.RouteMatch</span></a>, <em>REQUIRED</em>) The route matching parameter. Only when the match is satisfied, the “requires” field will
apply.</p>
<p>For example: following match will match all requests.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">match</span><span class="p">:</span>
  <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-requirementrule-requires">
<dt>requires</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirement"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirement</span></a>) Specify a Jwt Requirement. Please detail comment in message JwtRequirement.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-filterstaterule">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-filterstaterule"></span><h2>config.filter.http.jwt_authn.v2alpha.FilterStateRule<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-filterstaterule" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L386">[config.filter.http.jwt_authn.v2alpha.FilterStateRule proto]</a></p>
<p>This message specifies Jwt requirements based on stream_info.filterState.
This FilterState should use <cite>Router::StringAccessor</cite> object to set a string value.
Other HTTP filters can use it to specify Jwt requirements dynamically.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt_selector</span>
<span class="nt">requires</span><span class="p">:</span>
  <span class="nt">issuer_1</span><span class="p">:</span>
    <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">issuer1</span>
  <span class="nt">issuer_2</span><span class="p">:</span>
    <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">issuer2</span>
</pre></div>
</div>
<p>If a filter set “jwt_selector” with “issuer_1” to FilterState for a request,
jwt_authn filter will use JwtRequirement{“provider_name”: “issuer1”} to verify.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;requires&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-filterstaterule-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The filter state name to retrieve the <cite>Router::StringAccessor</cite> object.</p>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-filterstaterule-requires">
<dt>requires</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtrequirement"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtRequirement</span></a>&gt;) A map of string keys to requirements. The string key is the string value
in the FilterState with the name specified in the <em>name</em> field above.</p>
</dd>
</dl>
</div>
<div class="section" id="config-filter-http-jwt-authn-v2alpha-jwtauthentication">
<span id="envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtauthentication"></span><h2>config.filter.http.jwt_authn.v2alpha.JwtAuthentication<a class="headerlink" href="#config-filter-http-jwt-authn-v2alpha-jwtauthentication" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/8b1569ac0593c07345186022d2df60375d9be035/api/envoy/config/filter/http/jwt_authn/v2alpha/config.proto#L436">[config.filter.http.jwt_authn.v2alpha.JwtAuthentication proto]</a></p>
<p>This is the Envoy HTTP filter config for JWT authentication.</p>
<p>For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
   <span class="nt">provider1</span><span class="p">:</span>
     <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">issuer1</span>
     <span class="nt">audiences</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">audience1</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">audience2</span>
     <span class="nt">remote_jwks</span><span class="p">:</span>
       <span class="nt">http_uri</span><span class="p">:</span>
         <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com/.well-known/jwks.json</span>
         <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
   <span class="nt">provider2</span><span class="p">:</span>
     <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">issuer2</span>
     <span class="nt">local_jwks</span><span class="p">:</span>
       <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwks_string</span>

<span class="nt">rules</span><span class="p">:</span>
   <span class="c1"># Not jwt verification is required for /health path</span>
   <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
       <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/health</span>

   <span class="c1"># Jwt verification for provider1 is required for path prefixed with &quot;prefix&quot;</span>
   <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
       <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/prefix</span>
     <span class="nt">requires</span><span class="p">:</span>
       <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>

   <span class="c1"># Jwt verification for either provider1 or provider2 is required for all other requests.</span>
   <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
       <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
     <span class="nt">requires</span><span class="p">:</span>
       <span class="nt">requires_any</span><span class="p">:</span>
         <span class="nt">requirements</span><span class="p">:</span>
           <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
           <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;providers&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;filter_state_rules&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;bypass_cors_preflight&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtauthentication-providers">
<dt>providers</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-jwtprovider"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.JwtProvider</span></a>&gt;) Map of provider names to JwtProviders.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
  <span class="nt">provider1</span><span class="p">:</span>
     <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">issuer1</span>
     <span class="nt">audiences</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">audience1</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">audience2</span>
     <span class="nt">remote_jwks</span><span class="p">:</span>
       <span class="nt">http_uri</span><span class="p">:</span>
         <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com/.well-known/jwks.json</span>
         <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
  <span class=" -Error"> </span><span class="nt">provider2</span><span class="p">:</span>
     <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
     <span class="nt">local_jwks</span><span class="p">:</span>
       <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwks_string</span>
</pre></div>
</div>
</dd>
</dl>
<dl id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtauthentication-rules">
<dt>rules</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-requirementrule"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.RequirementRule</span></a>) Specifies requirements based on the route matches. The first matched requirement will be
applied. If there are overlapped match conditions, please put the most specific match first.</p>
<p>Examples</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
      <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/healthz</span>
  <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
      <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/baz</span>
    <span class="nt">requires</span><span class="p">:</span>
      <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
  <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
      <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/foo</span>
    <span class="nt">requires</span><span class="p">:</span>
      <span class="nt">requires_any</span><span class="p">:</span>
        <span class="nt">requirements</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
          <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
  <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
      <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/bar</span>
    <span class="nt">requires</span><span class="p">:</span>
      <span class="nt">requires_all</span><span class="p">:</span>
        <span class="nt">requirements</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
          <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtauthentication-filter-state-rules">
<dt>filter_state_rules</dt><dd><p>(<a class="reference internal" href="#envoy-api-msg-config-filter-http-jwt-authn-v2alpha-filterstaterule"><span class="std std-ref">config.filter.http.jwt_authn.v2alpha.FilterStateRule</span></a>) This message specifies Jwt requirements based on stream_info.filterState.
Other HTTP filters can use it to specify Jwt requirements dynamically.
The <em>rules</em> field above is checked first, if it could not find any matches,
check this one.</p>
</dd>
</dl>
<dl class="simple" id="envoy-api-field-config-filter-http-jwt-authn-v2alpha-jwtauthentication-bypass-cors-preflight">
<dt>bypass_cors_preflight</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) When set to true, bypass the <a class="reference external" href="http://www.w3.org/TR/cors/#cross-origin-request-with-preflight">CORS preflight request</a> regardless of JWT
requirements specified in the rules.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../tap/v2alpha/tap.proto.html" class="btn btn-neutral float-right" title="Tap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../grpc_stats/v2alpha/config.proto.html" class="btn btn-neutral float-left" title="gRPC statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2020, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>