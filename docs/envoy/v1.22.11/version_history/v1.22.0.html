<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.22.0 (April 15, 2022) &mdash; envoy tag-v1.22.11 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/envoy.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.21.6 (November 28, 2022)" href="v1.21.6.html" />
    <link rel="prev" title="1.22.1 (June 9, 2022)" href="v1.22.1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                tag-v1.22.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/overview.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="version_history.html">Version history</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="current.html">1.22.11 (April 11, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.10.html">1.22.10 (April 4, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.9.html">1.22.9 (March 22, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.8.html">1.22.8 (February 24, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.7.html">1.22.7 (February 7, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.6.html">1.22.6 (November 30, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.5.html">1.22.5 (August 12, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.4.html">1.22.4 (July 27, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.3.html">1.22.3 (July 27, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.2.html">1.22.2 (June 10, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.22.1.html">1.22.1 (June 9, 2022)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.22.0 (April 15, 2022)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#incompatible-behavior-changes">Incompatible Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minor-behavior-changes">Minor Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removed-config-or-runtime">Removed Config or Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deprecated">Deprecated</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.6.html">1.21.6 (November 28, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.5.html">1.21.5 (July 25, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.4.html">1.21.4 (June 14, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.3.html">1.21.3 (June 9, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.2.html">1.21.2 (April 27, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.1.html">1.21.1 (February 22, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.21.0.html">1.21.0 (January 12, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.7.html">1.20.7 (July 21, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.6.html">1.20.6 (June 16, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.5.html">1.20.5 (June 16, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.4.html">1.20.4 (June 9, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.3.html">1.20.3 (April 26, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.2.html">1.20.2 (February 22, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.1.html">1.20.1 (November 30, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.20.0.html">1.20.0 (October 5, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.5.html">1.19.5 (June 9, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.4.html">1.19.4 (April 25, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.3.html">1.19.3 (February 22, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.1.html">1.19.1 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.19.0.html">1.19.0 (July 13, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.6.html">1.18.6 (February 22, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.4.html">1.18.4 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.3.html">1.18.3 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.2.html">1.18.2 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.1.html">1.18.1 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.18.0.html">1.18.0 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.4.html">1.17.4 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.3.html">1.17.3 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.2.html">1.17.2 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.1.html">1.17.1 (February 25, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.17.0.html">1.17.0 (January 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.5.html">1.16.5 (Aug 24, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.4.html">1.16.4 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.3.html">1.16.3 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.2.html">1.16.2 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.1.html">1.16.1 (November 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.0.html">1.16.0 (October 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.5.html">1.15.5 (May 11, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.4.html">1.15.4 (April 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.3.html">1.15.3 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.2.html">1.15.2 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.1.html">1.15.1 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.0.html">1.15.0 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.7.html">1.14.7 (April 15, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.6.html">1.14.6 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.5.html">1.14.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.4.html">1.14.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.3.html">1.14.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.2.html">1.14.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.1.html">1.14.1 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.0.html">1.14.0 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.8.html">1.13.8 (January 15, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.7.html">1.13.7 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.6.html">1.13.6 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.5.html">1.13.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.4.html">1.13.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.3.html">1.13.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.2.html">1.13.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.1.html">1.13.1 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.0.html">1.13.0 (January 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.7.html">1.12.7 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.6.html">1.12.6 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.5.html">1.12.5 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.4.html">1.12.4 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.3.html">1.12.3 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.2.html">1.12.2 (December 10, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.1.html">1.12.1 (November 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.0.html">1.12.0 (October 31, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.2.html">1.11.2 (October 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.1.html">1.11.1 (August 13, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.0.html">1.11.0 (July 11, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.10.0.html">1.10.0 (Apr 5, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.1.html">1.9.1 (Apr 2, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.0.html">1.9.0 (Dec 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.8.0.html">1.8.0 (Oct 4, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.7.0.html">1.7.0 (Jun 21, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.6.0.html">1.6.0 (March 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.5.0.html">1.5.0 (December 4, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.4.0.html">1.4.0 (August 24, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.3.0.html">1.3.0 (May 17, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.2.0.html">1.2.0 (March 7, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.1.0.html">1.1.0 (November 30, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.0.0.html">1.0.0 (September 12, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#deprecation-policy">Deprecation Policy</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="version_history.html">Version history</a> &raquo;</li>
      <li>1.22.0 (April 15, 2022)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/version_history/v1.22.0.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="april-15-2022">
<h1>1.22.0 (April 15, 2022)<a class="headerlink" href="#april-15-2022" title="Permalink to this headline">¶</a></h1>
<div class="section" id="incompatible-behavior-changes">
<h2>Incompatible Behavior Changes<a class="headerlink" href="#incompatible-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required</em></p>
<ul class="simple">
<li><p>sip-proxy: change API by replacing <code class="docutils literal notranslate"><span class="pre">own_domain</span></code> with <a class="reference internal" href="../api-v3/extensions/filters/network/sip_proxy/v3alpha/sip_proxy.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-v3alpha-localservice"><span class="std std-ref">local_services</span></a>.</p></li>
<li><p>tls: set TLS v1.2 as the default minimal version for servers. Users can still explicitly opt-in to 1.0 and 1.1 using <a class="reference internal" href="../api-v3/extensions/transport_sockets/tls/v3/common.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-tls-minimum-protocol-version"><span class="std std-ref">tls_minimum_protocol_version</span></a>.</p></li>
</ul>
</div>
<div class="section" id="minor-behavior-changes">
<h2>Minor Behavior Changes<a class="headerlink" href="#minor-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that may cause incompatibilities for some users, but should not for most</em></p>
<ul class="simple">
<li><p>access_log: log all header values in the grpc access log.</p></li>
<li><p>build: <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> and <code class="docutils literal notranslate"><span class="pre">API_VERSION</span></code> have been renamed to <code class="docutils literal notranslate"><span class="pre">VERSION.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">API_VERSION.txt</span></code> respectively to avoid conflicts with the C++ <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> header.</p></li>
<li><p>config: type URL is used to lookup extensions regardless of the name field. This may cause problems for empty filter configurations or mis-matched protobuf as the typed configurations. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.no_extension_lookup_by_name</span></code> to false.</p></li>
<li><p>config: warning messages for protobuf unknown fields now contain ancestors for easier troubleshooting.</p></li>
<li><p>cryptomb: remove RSA PKCS1 v1.5 padding support.</p></li>
<li><p>decompressor: decompressor does not duplicate <code class="docutils literal notranslate"><span class="pre">accept-encoding</span></code> header values anymore. This behavioral change can be reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.append_to_accept_content_encoding_only_once</span></code> to false.</p></li>
<li><p>dynamic_forward_proxy: if a DNS resolution fails, failing immediately with a specific resolution error, rather than finishing up all local filters and failing to select an upstream host.</p></li>
<li><p>ecds: changed to use <code class="docutils literal notranslate"><span class="pre">http_filter</span></code> stat prefix as the metrics root for ECDS subscriptions. This behavior can be temporarily reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.top_level_ecds_stats</span></code> to false.</p></li>
<li><p>ext_authz: added requested server name in ext_authz network filter for auth review.</p></li>
<li><p>ext_authz: forward <a class="reference internal" href="../api-v3/config/core/v3/base.proto.html#envoy-v3-api-field-config-core-v3-metadata-typed-filter-metadata"><span class="std std-ref">typed_filter_metadata</span></a> selected by <a class="reference internal" href="../api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-extauthz-typed-metadata-context-namespaces"><span class="std std-ref">typed_metadata_context_namespaces</span></a> to external auth service.</p></li>
<li><p>file: changed disk based files to truncate files which are not being appended to. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.append_or_truncate</span></code> to false.</p></li>
<li><p>grpc: flip runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.enable_grpc_async_client_cache</span></code> to be default enabled. async grpc client created through <code class="docutils literal notranslate"><span class="pre">getOrCreateRawAsyncClient</span></code> will be cached by default.</p></li>
<li><p>health_checker: exposing <code class="docutils literal notranslate"><span class="pre">initial_metadata</span></code> to GrpcHealthCheck in a way similar to <code class="docutils literal notranslate"><span class="pre">request_headers_to_add</span></code> of HttpHealthCheck.</p></li>
<li><p>http: added the ability to have multiple URI type Subject Alternative Names of the client certificate in the <a class="reference internal" href="../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-client-cert"><span class="std std-ref">x-forwarded-client-cert</span></a> header.</p></li>
<li><p>http: avoiding delay-close for HTTP/1.0 responses framed by <code class="docutils literal notranslate"><span class="pre">connection:</span> <span class="pre">close</span></code> as well as HTTP/1.1 if the request is fully read. This means for responses to such requests, the FIN will be sent immediately after the response. This behavior can be temporarily reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.skip_delay_close</span></code> to false.  If clients are seen to be receiving sporadic partial responses and flipping this flag fixes it, please notify the project immediately.</p></li>
<li><p>http: changed the http status code to 504 from 408 if the request times out after the request is completed. This behavior can be temporarily reverted by setting the runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.override_request_timeout_by_gateway_timeout</span></code> to false.</p></li>
<li><p>http: lazy disable downstream connection reading in the HTTP/1 codec to reduce unnecessary system calls. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http1_lazy_read_disable</span></code> to false.</p></li>
<li><p>http: now the max concurrent streams of http2 connection can not only be adjusted down according to the SETTINGS frame but also can be adjusted up. Of course, it can not exceed the configured upper bounds. This fix is guarded by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_allow_capacity_increase_by_settings</span></code>.</p></li>
<li><p>http: respecting <code class="docutils literal notranslate"><span class="pre">content-type</span></code> in <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-headers-to-add"><span class="std std-ref">headers_to_add</span></a> even when the response body is modified. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_adding_content_type_in_local_replies</span></code> to false.</p></li>
<li><p>http: when writing custom filters, <code class="docutils literal notranslate"><span class="pre">injectEncodedDataToFilterChain</span></code> and <code class="docutils literal notranslate"><span class="pre">injectDecodedDataToFilterChain</span></code> now trigger sending of headers if they were not yet sent due to <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>. Previously, calling one of the inject functions in that state would trigger an assertion. See issue #19891 for more details.</p></li>
<li><p>listener: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.9.1/api-v2/api/v2/core/address.proto.html#envoy-api-field-core-socketaddress-ipv4-compat" title="(in envoy vtag-v1.9.1)"><span class="xref std std-ref">ipv4_compat</span></a> flag can only be set on Ipv6 address and Ipv4-mapped Ipv6 address. A runtime guard is added <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.strict_check_on_ipv4_compat</span></code> and the default is true.</p></li>
<li><p>network: add a new ConnectionEvent <code class="docutils literal notranslate"><span class="pre">ConnectedZeroRtt</span></code> which may be raised by QUIC connections to allow early data to be sent before the handshake finishes. This event is ignored at callsites which is only reachable for TCP connections in the Envoy core code. Any extensions which depend on ConnectionEvent enum value should audit their usage of it to make sure this new event is handled appropriately.</p></li>
<li><p>oauth2: disable chunked transfer encoding in the token request to be compatible with Azure AD (login.microsoftonline.com).</p></li>
<li><p>perf: tls contexts are now tracked without scan based garbage collection greatly improving the performance on secret update.</p></li>
<li><p>ratelimit: the <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-msg-config-route-v3-ratelimit-action-headervaluematch"><span class="std std-ref">header_value_match</span></a> config now supports custom descriptor keys.</p></li>
<li><p>router: record upstream request timeouts for all cases and not just for those requests which are awaiting headers. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.do_not_await_headers_on_upstream_timeout_to_emit_stats</span></code> to false.</p></li>
<li><p>runtime: deprecated runtime flags set via configuration files or xDS will now ENVOY_BUG, rather than silently resulting in unexpected behavior on the data plane by no longer applying removed code paths.</p></li>
<li><p>runtime: removed global runtime as Envoy default. This behavioral change can be reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.restart_features.no_runtime_singleton</span></code> to false.</p></li>
<li><p>sip-proxy: add customized affinity support by adding <a class="reference internal" href="../api-v3/extensions/filters/network/sip_proxy/tra/v3alpha/tra.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-tra-v3alpha-traserviceconfig"><span class="std std-ref">tra_service_config</span></a> and <a class="reference internal" href="../api-v3/extensions/filters/network/sip_proxy/v3alpha/sip_proxy.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-v3alpha-customizedaffinity"><span class="std std-ref">customized_affinity</span></a>.</p></li>
<li><p>sip-proxy: add support for the <code class="docutils literal notranslate"><span class="pre">503</span></code> response code. When there is something wrong occurred, send <code class="docutils literal notranslate"><span class="pre">503</span> <span class="pre">Service</span> <span class="pre">Unavailable</span></code> back to downstream.</p></li>
<li><p>stateful session http filter: only enable cookie based session state when request path matches the configured cookie path.</p></li>
<li><p>tracing: set tracing error tag for grpc non-ok response code only when it is a upstream error. Client error will not be tagged as a grpc error. This fix is guarded by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.update_grpc_response_error_tag</span></code>.</p></li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h2>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes expected to improve the state of the world and are unlikely to have negative effects</em></p>
<ul class="simple">
<li><p>access_log: fix memory leak when reopening an access log fails. Access logs will now try to be reopened on each subsequent flush attempt after a failure.</p></li>
<li><p>data plane: fix crash when internal redirect selects a route configured with direct response or redirect actions.</p></li>
<li><p>data plane: fix error handling where writing to a socket failed while under the stack of processing. This should only effect HTTP/3. This behavioral change can be reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_upstream_inline_write</span></code> to false.</p></li>
<li><p>eds: fix the eds cluster update by allowing update on the locality of the cluster endpoints. This behavioral change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.support_locality_update_on_eds_cluster_endpoints</span></code> to false.</p></li>
<li><p>hot restart: fixed a bug where an incorrect fd was passed to child when a tcp listener and a udp listener listen to the same address because socket type was not used to find the matching listener for a url.</p></li>
<li><p>http: fixed a bug where <code class="docutils literal notranslate"><span class="pre">%RESPONSE_CODE_DETAILS%</span></code> was not set correctly in <a class="reference internal" href="../api-v3/config/route/v3/route.proto.html#envoy-v3-api-field-config-route-v3-routeconfiguration-request-headers-to-add"><span class="std std-ref">request_headers_to_add</span></a>.</p></li>
<li><p>http: fixed a bug where <code class="docutils literal notranslate"><span class="pre">100-continue</span></code> comparison in the <code class="docutils literal notranslate"><span class="pre">Expect</span></code> request header field was case sensitive. This RFC compliant behavior can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_100_continue_case_insensitive</span></code> to false.</p></li>
<li><p>jwt_authn: fixed a bug where a JWT with empty “iss” is passed even the field <a class="reference internal" href="../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-issuer"><span class="std std-ref">issuer</span></a> is specified. If the “issuer” field is specified, “iss” in the JWT should match it.</p></li>
<li><p>jwt_authn: fixed the crash when a CONNECT request is sent to JWT filter configured with regex match on the Host header.</p></li>
<li><p>router: fixed mirror policy <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-runtime-fraction"><span class="std std-ref">runtime_fraction</span></a> to
correctly allow reading from a fractional percent value stored in runtime in all cases. Previously
it would only do this if the default numerator was above 0, otherwise it would use the integer
variant with a default of 0. The default of 0 is retained, but runtime lookup will happen in
all cases and recognize a stored fractional percent.</p></li>
<li><p>tcp_proxy: fix a crash that occurs when configured for <a class="reference internal" href="../api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-tunneling-config"><span class="std std-ref">upstream tunneling</span></a> and the downstream connection disconnects while the the upstream connection or http/2 stream is still being established.</p></li>
<li><p>tls: fix a bug while matching a certificate SAN with an exact value in <code class="docutils literal notranslate"><span class="pre">match_typed_subject_alt_names</span></code> of a listener where wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> character is not the only character of the dns label. Example, <code class="docutils literal notranslate"><span class="pre">baz*.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">*baz.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">b*z.example.net</span></code> will match <code class="docutils literal notranslate"><span class="pre">baz1.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">foobaz.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">buzz.example.net</span></code>, respectively.</p></li>
<li><p>upstream: added cluster slow start config <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-slowstartconfig-min-weight-percent"><span class="std std-ref">min_weight_percent</span></a> field to avoid too big EDF deadline which cause slow start endpoints receiving no traffic, default 10%. This fix is related to <a class="reference external" href="https://github.com/envoyproxy/envoy/issues/19526">issue #19526</a>.</p></li>
<li><p>upstream: fix stack overflow when a cluster with large number of idle connections is removed.</p></li>
<li><p>xds: fix a crash that occurs when Envoy receives a discovery response without <code class="docutils literal notranslate"><span class="pre">control_plane</span></code> field.</p></li>
<li><p>xds: fix the wildcard resource versions that are sent upon reconnection when using delta-xds mode.</p></li>
<li><p>xray: fix the AWS X-Ray tracer extension to not sample the trace if <code class="docutils literal notranslate"><span class="pre">sampled=</span></code> keyword is not present in the header <code class="docutils literal notranslate"><span class="pre">x-amzn-trace-id</span></code>.</p></li>
<li><p>xray: fix the AWS X-Ray tracer extension to annotate a child span with <code class="docutils literal notranslate"><span class="pre">type=subsegment</span></code> to correctly relate subsegments to a parent segment. Previously a subsegment would be treated as an independent segment.</p></li>
<li><p>xray: fix the AWS X-Ray tracer extension to reuse the trace ID already present in the header <code class="docutils literal notranslate"><span class="pre">x-amzn-trace-id</span></code> instead of creating a new one.</p></li>
<li><p>xray: fix the AWS X-Ray tracer extension to set the HTTP <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header value as <code class="docutils literal notranslate"><span class="pre">client_ip</span></code> in the segment data.</p></li>
</ul>
</div>
<div class="section" id="removed-config-or-runtime">
<h2>Removed Config or Runtime<a class="headerlink" href="#removed-config-or-runtime" title="Permalink to this headline">¶</a></h2>
<p><em>Normally occurs at the end of the</em> <a class="reference internal" href="version_history.html#deprecated"><span class="std std-ref">deprecation period</span></a></p>
<ul class="simple">
<li><p>access_log: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.unquote_log_string_values</span></code> and legacy code paths.</p></li>
<li><p>grpc_bridge_filter: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.grpc_bridge_stats_disabled</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.hash_multiple_header_values</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.no_chunked_encoding_header_for_304</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.preserve_downstream_scheme</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.require_strict_1xx_and_204_response_headers</span></code> and <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.send_strict_1xx_and_204_response_headers</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.strip_port_from_connect</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_observable_cluster_name</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_transport_failure_reason_in_body</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_response_for_timeout</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_consume_stream_refused_errors</span></code> and legacy code paths.</p></li>
<li><p>http: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.internal_redirects_with_body</span></code> and legacy code paths.</p></li>
<li><p>json: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.remove_legacy_json</span></code> and legacy code paths.</p></li>
<li><p>listener: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.listener_reuse_port_default_enabled</span></code> and legacy code paths.</p></li>
<li><p>listener: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.listener_wildcard_match_ip_family</span></code> and legacy code paths.</p></li>
<li><p>udp: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.udp_per_event_loop_read_limit</span></code> and legacy code paths.</p></li>
<li><p>upstream: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.health_check.graceful_goaway_handling</span></code> and legacy code paths.</p></li>
<li><p>xds: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.vhds_heartbeats</span></code> and legacy code paths.</p></li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>access_log: added new access_log command operator <code class="docutils literal notranslate"><span class="pre">%GRPC_STATUS_NUMBER%</span></code>.</p></li>
<li><p>access_log: added new access_log command operator <code class="docutils literal notranslate"><span class="pre">%ENVIRONMENT(X):Z%</span></code>.</p></li>
<li><p>access_log: added TCP proxy upstream and downstream byte logging. This can be accessed through the <code class="docutils literal notranslate"><span class="pre">%DOWNSTREAM_WIRE_BYTES_SENT%</span></code>, <code class="docutils literal notranslate"><span class="pre">%DOWNSTREAM_WIRE_BYTES_RECEIVED%</span></code>, <code class="docutils literal notranslate"><span class="pre">%UPSTREAM_WIRE_BYTES_SENT%</span></code>, and <code class="docutils literal notranslate"><span class="pre">%UPSTREAM_WIRE_BYTES_RECEIVED%</span></code> access_log command operatrors.</p></li>
<li><p>access_log: make consistent access_log format fields <code class="docutils literal notranslate"><span class="pre">%(DOWN|DIRECT_DOWN|UP)STREAM_(LOCAL|REMOTE)_*%</span></code> to provide all combinations of local &amp; remote addresses for upstream &amp; downstream connections.</p></li>
<li><p>admin: <a class="reference internal" href="../operations/admin.html#post--logging" title="POST /logging"><code class="xref http http-post docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/logging</span></code></a> now accepts <code class="docutils literal notranslate"><span class="pre">/logging?paths=name1:level1,name2:level2,...</span></code> to change multiple log levels at once.</p></li>
<li><p>cluster: added support for per host limits in <a class="reference internal" href="../api-v3/config/cluster/v3/circuit_breaker.proto.html#envoy-v3-api-msg-config-cluster-v3-circuitbreakers"><span class="std std-ref">circuit breakers settings</span></a>. Currently only  <a class="reference internal" href="../api-v3/config/cluster/v3/circuit_breaker.proto.html#envoy-v3-api-field-config-cluster-v3-circuitbreakers-thresholds-max-connections"><span class="std std-ref">max_connections</span></a> is supported.</p></li>
<li><p>cluster: added support to restore original destination address from any desired header via setting <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-originaldstlbconfig-http-header-name"><span class="std std-ref">http_header_name</span></a>.</p></li>
<li><p>cluster: support <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-override-host-status"><span class="std std-ref">override host status restriction</span></a>.</p></li>
<li><p>compression: add zstd <a class="reference internal" href="../api-v3/extensions/compression/zstd/compressor/v3/zstd.proto.html#envoy-v3-api-msg-extensions-compression-zstd-compressor-v3-zstd"><span class="std std-ref">compressor</span></a> and <a class="reference internal" href="../api-v3/extensions/compression/zstd/decompressor/v3/zstd.proto.html#envoy-v3-api-msg-extensions-compression-zstd-decompressor-v3-zstd"><span class="std std-ref">decompressor</span></a>.</p></li>
<li><p>config: added new file based xDS configuration via <a class="reference internal" href="../api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path-config-source"><span class="std std-ref">path_config_source</span></a>.
<a class="reference internal" href="../api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-pathconfigsource-watched-directory"><span class="std std-ref">watched_directory</span></a> can
be used to setup an independent watch for when to reload the file path, for example when using
Kubernetes ConfigMaps to deliver configuration. See the linked documentation for more information.</p></li>
<li><p>config: added new <a class="reference internal" href="../configuration/operations/config_validation/config_validation.html#config-config-validation"><span class="std std-ref">custom config validators</span></a> to dynamically verify config updates.</p></li>
<li><p>cors: add dynamic support for headers <code class="docutils literal notranslate"><span class="pre">access-control-allow-methods</span></code> and <code class="docutils literal notranslate"><span class="pre">access-control-allow-headers</span></code> in cors.</p></li>
<li><p>dns: added <a class="reference internal" href="../api-v3/extensions/common/dynamic_forward_proxy/v3/dns_cache.proto.html#envoy-v3-api-field-extensions-common-dynamic-forward-proxy-v3-dnscacheconfig-dns-min-refresh-rate"><span class="std std-ref">dns_min_refresh_rate</span></a>
to the DNS cache implementation to configure the minimum DNS refresh rate, regardless of returned
TTL. This was previously hard coded to 5s and defaults to 5s if unset.</p></li>
<li><p>gcp authentication http filter: added <a class="reference internal" href="../configuration/http/http_filters/gcp_authn_filter.html#config-http-filters-gcp-authn"><span class="std std-ref">gcp authentication http filter</span></a>.</p></li>
<li><p>http: added <code class="docutils literal notranslate"><span class="pre">random_value_specifier</span></code> in <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a> to allow random value to be specified from configuration proto.</p></li>
<li><p>http: added <code class="docutils literal notranslate"><span class="pre">request_mirror_policies</span></code> to higher levels (i.e., <a class="reference internal" href="../api-v3/config/route/v3/route.proto.html#envoy-v3-api-field-config-route-v3-routeconfiguration-request-mirror-policies"><span class="std std-ref">request_mirror_policies</span></a> in <a class="reference internal" href="../api-v3/config/route/v3/route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">RouteConfiguration</span></a> and  <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-virtualhost-request-mirror-policies"><span class="std std-ref">request_mirror_policies</span></a> in <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">VirtualHost</span></a>) which applies to <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-request-mirror-policies"><span class="std std-ref">request_mirror_policies</span></a> in all routes underneath without configured mirror policies.</p></li>
<li><p>http: added support for <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig-cidr-ranges"><span class="std std-ref">cidr_ranges</span></a> for configuring list of CIDR ranges that are considered internal.</p></li>
<li><p>http: added support for <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-proxy-status-config"><span class="std std-ref">proxy_status_config</span></a> for configuring <a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-proxy-status-08">Proxy-Status</a> HTTP response header fields.</p></li>
<li><p>http: make consistent custom header format fields <code class="docutils literal notranslate"><span class="pre">%(DOWN|DIRECT_DOWN|UP)STREAM_(LOCAL|REMOTE)_*%</span></code> to provide all combinations of local &amp; remote addresses for upstream &amp; downstream connections.</p></li>
<li><p>http2: adds the new runtime feature <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_use_oghttp2</span></code>, disabled by default, that guards use of a new HTTP/2 implementation.</p></li>
<li><p>http2: re-enabled the HTTP/2 wrapper API. This should be a transparent change that does not affect functionality. Any behavior changes can be reverted by setting the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_new_codec_wrapper</span></code> runtime feature to false.</p></li>
<li><p>http3: add <a class="reference internal" href="../api-v3/extensions/transport_sockets/quic/v3/quic_transport.proto.html#envoy-v3-api-field-extensions-transport-sockets-quic-v3-quicdownstreamtransport-enable-early-data"><span class="std std-ref">enable_early_data</span></a> to turn on/off downstream early data support.</p></li>
<li><p>http3: downstream HTTP/3 support is now GA! Upstream HTTP/3 also GA for specific deployments. See <a class="reference internal" href="../intro/arch_overview/http/http3.html#arch-overview-http3"><span class="std std-ref">here</span></a> for details.</p></li>
<li><p>http3: supports upstream HTTP/3 retries. Automatically retry <a class="reference external" href="https://www.rfc-editor.org/rfc/rfc7231#section-4.2.1">0-RTT safe requests</a> if they are rejected because they are sent <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8470#section-5.2">too early</a>. And automatically retry 0-RTT safe requests if connect attempt fails later on and the cluster is configured with TCP fallback. And add retry on <code class="docutils literal notranslate"><span class="pre">http3-post-connect-failure</span></code> policy which allows retry of failed HTTP/3 requests with TCP fallback even after handshake if the cluster is configured with TCP fallback. This feature is guarded by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.conn_pool_new_stream_with_early_data_and_http3</span></code>.</p></li>
<li><p>listener: implement <a class="reference internal" href="../intro/arch_overview/advanced/matching/matching_listener.html#arch-overview-matching-listener"><span class="std std-ref">matching API</span></a> for selecting filter chains.</p></li>
<li><p>local_ratelimit: added support for sharing the rate limiter between multiple network filter chains or listeners via <a class="reference internal" href="../api-v3/extensions/filters/network/local_ratelimit/v3/local_rate_limit.proto.html#envoy-v3-api-field-extensions-filters-network-local-ratelimit-v3-localratelimit-share-key"><span class="std std-ref">share_key</span></a>.</p></li>
<li><p>local_ratelimit: added support for <code class="docutils literal notranslate"><span class="pre">X-RateLimit-*</span></code> headers as defined in <a class="reference external" href="https://tools.ietf.org/id/draft-polli-ratelimit-headers-03.html">draft RFC</a>.</p></li>
<li><p>matching: the matching API can now express a match tree that will always match by omitting a matcher at the top level.</p></li>
<li><p>outlier_detection: <a class="reference internal" href="../api-v3/config/cluster/v3/outlier_detection.proto.html#envoy-v3-api-field-config-cluster-v3-outlierdetection-base-ejection-time"><span class="std std-ref">max_ejection_time_jitter</span></a> configuration added to allow adding a random value to the ejection time to prevent ‘thundering herd’ scenarios. Defaults to 0 so as to not break or change the behavior of existing deployments.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/extensions/filters/http/ratelimit/v3/rate_limit.proto.html#envoy-v3-api-field-extensions-filters-http-ratelimit-v3-ratelimit-rate-limited-status"><span class="std std-ref">rate_limited_status</span></a> to support return a custom HTTP response status code to the downstream client when the request has been rate limited.</p></li>
<li><p>ratelimit: network rate limiter supports runtime value substitution using stream info and substitution formatting via <a class="reference internal" href="../configuration/listeners/network_filters/rate_limit_filter.html#config-network-filters-ratelimit-substitution-formatter"><span class="std std-ref">Network Rate Limiter</span></a>.</p></li>
<li><p>redis: support for hostnames returned in <code class="docutils literal notranslate"><span class="pre">cluster_slots</span></code> response is now available.</p></li>
<li><p>router: added <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routematch-path-separated-prefix"><span class="std std-ref">path_separated_prefix</span></a> to make route creation more efficient.</p></li>
<li><p>schema_validator_tool: added <code class="docutils literal notranslate"><span class="pre">bootstrap</span></code> checking to the
<a class="reference internal" href="../operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool"><span class="std std-ref">schema validator check tool</span></a>.</p></li>
<li><p>schema_validator_tool: added <code class="docutils literal notranslate"><span class="pre">--fail-on-deprecated</span></code> and <code class="docutils literal notranslate"><span class="pre">--fail-on-wip</span></code> to the
<a class="reference internal" href="../operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool"><span class="std std-ref">schema validator check tool</span></a> to allow failing
the check if either deprecated or work-in-progress fields are used.</p></li>
<li><p>schema_validator_tool: fixed linking of all extensions into the
<a class="reference internal" href="../operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool"><span class="std std-ref">schema validator check tool</span></a> so that all typed
configurations can be properly verified.</p></li>
<li><p>schema_validator_tool: the
<a class="reference internal" href="../operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool"><span class="std std-ref">schema validator check tool</span></a> will now recurse
into all sub messages, including Any messages, and perform full validation (deprecation,
work-in-progress, PGV, etc.). Previously only top-level messages were fully validated.</p></li>
<li><p>stats: histogram_buckets query parameter added to stats endpoint to change histogram output to show buckets.</p></li>
<li><p>tap: added support for buffering an arbitrary number of tapped traces before returning to the client via a new <a class="reference internal" href="../api-v3/config/tap/v3/common.proto.html#envoy-v3-api-field-config-tap-v3-outputsink-buffered-admin"><span class="std std-ref">buffered admin sink</span></a>.</p></li>
<li><p>tcp_proxy: added support for on demand cluster. If the <a class="reference internal" href="../api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-on-demand"><span class="std std-ref">on_demand</span></a> is set and the destination cluster is not present, a delta CDS request will be sent and the tcp proxy flow will be resumed after that cds response.</p></li>
<li><p>thrift: add support for connection draining. This can be enabled by setting the runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.thrift_connection_draining</span></code> to true.</p></li>
<li><p>thrift: added support for dynamic routing through aggregated discovery service.</p></li>
<li><p>tls: add support for tls key log <a class="reference internal" href="../api-v3/extensions/transport_sockets/tls/v3/tls.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-commontlscontext-key-log"><span class="std std-ref">key_log</span></a>.</p></li>
<li><p>tools: the project now ships a <a class="reference internal" href="../start/install.html#install-tools"><span class="std std-ref">tools docker image</span></a> which contains tools
useful in support systems such as CI, CD, etc. The
<a class="reference internal" href="../operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool"><span class="std std-ref">schema validator check tool</span></a> has been added
to the tools image.</p></li>
<li><p>udp_proxy: added <a class="reference internal" href="../api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-matcher"><span class="std std-ref">matcher</span></a> to support matching and routing to different clusters.</p></li>
<li><p>udp_proxy: added support for <a class="reference internal" href="../api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-access-log"><span class="std std-ref">access_log</span></a>.</p></li>
</ul>
</div>
<div class="section" id="deprecated">
<h2>Deprecated<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>config: deprecated <a class="reference internal" href="../api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path"><span class="std std-ref">path</span></a> in favor of
<a class="reference internal" href="../api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path-config-source"><span class="std std-ref">path_config_source</span></a></p></li>
<li><p>http: deprecated <code class="docutils literal notranslate"><span class="pre">envoy.http.headermap.lazy_map_min_size</span></code>.  If you are using this config knob you can revert this temporarily by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.deprecate_global_ints</span></code> to true but you MUST file an upstream issue to ensure this feature remains available.</p></li>
<li><p>http: removing support for long-deprecated old style filter names, e.g. envoy.router, envoy.lua.</p></li>
<li><p>re2: removed undocumented histograms <code class="docutils literal notranslate"><span class="pre">re2.program_size</span></code> and <code class="docutils literal notranslate"><span class="pre">re2.exceeded_warn_level</span></code>.</p></li>
<li><p>thrift: deprecated TTwitter protocol since we believe it’s not used and it’s causing significant maintenance burden.</p></li>
<li><p>udp_proxy: deprecated <a class="reference internal" href="../api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-cluster"><span class="std std-ref">cluster</span></a> in favor of <a class="reference internal" href="../api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-matcher"><span class="std std-ref">matcher</span></a>.</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="v1.22.1.html" class="btn btn-neutral float-left" title="1.22.1 (June 9, 2022)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="v1.21.6.html" class="btn btn-neutral float-right" title="1.21.6 (November 28, 2022)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2023, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>