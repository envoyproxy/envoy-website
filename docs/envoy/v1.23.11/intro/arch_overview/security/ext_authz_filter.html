<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External Authorization &mdash; envoy 1.23.11-84dd90 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/envoy.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" src="../../../_static/jquery.js"></script>
        <script integrity="sha384-lSZeSIVKp9myfKbDQ3GkN/KHjUc+mzg17VKDN4Y2kUeBSJioB9QSM639vM9fuY//" src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Attribute Context (proto)" href="../../../api-v3/service/auth/v3/attribute_context.proto.html" />
    <link rel="prev" title="JSON Web Token (JWT) Authentication" href="jwt_authn_filter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.23.11-84dd90
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../intro.html">Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../what_is_envoy.html">What is Envoy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../arch_overview.html">Architecture overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../listeners/listeners_toc.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../http/http.html">HTTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability/observability.html">Observability</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="security.html">Security</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ssl.html">TLS</a></li>
<li class="toctree-l4"><a class="reference internal" href="jwt_authn_filter.html">JSON Web Token (JWT) Authentication</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">External Authorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="rbac_filter.html">Role Based Access Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html">Threat model</a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html#extension-security-robust-to-untrusted-downstream-and-upstream">Extension security: <code class="docutils literal notranslate"><span class="pre">robust_to_untrusted_downstream_and_upstream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html#extension-security-data-plane-agnostic">Extension security: <code class="docutils literal notranslate"><span class="pre">data_plane_agnostic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html#extension-security-robust-to-untrusted-downstream">Extension security: <code class="docutils literal notranslate"><span class="pre">robust_to_untrusted_downstream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html#extension-security-requires-trusted-downstream-and-upstream">Extension security: <code class="docutils literal notranslate"><span class="pre">requires_trusted_downstream_and_upstream</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="threat_model.html#extension-security-unknown">Extension security: <code class="docutils literal notranslate"><span class="pre">unknown</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html">External dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-dataplane-core">External dependencies: <code class="docutils literal notranslate"><span class="pre">dataplane_core</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-dataplane-ext">External dependencies: <code class="docutils literal notranslate"><span class="pre">dataplane_ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-controlplane">External dependencies: <code class="docutils literal notranslate"><span class="pre">controlplane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-api">External dependencies: <code class="docutils literal notranslate"><span class="pre">api</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-observability-core">External dependencies: <code class="docutils literal notranslate"><span class="pre">observability_core</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-observability-ext">External dependencies: <code class="docutils literal notranslate"><span class="pre">observability_ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-build">External dependencies: <code class="docutils literal notranslate"><span class="pre">build</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-other">External dependencies: <code class="docutils literal notranslate"><span class="pre">other</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="external_deps.html#external-dependencies-test-only">External dependencies: <code class="docutils literal notranslate"><span class="pre">test_only</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="google_vrp.html">Google Vulnerability Reward Program (VRP)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../operations/operations.html">Operations &amp; configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../other_features/other_features.html">Other features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../other_protocols/other_protocols.html">Other protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../advanced/advanced.html">Advanced</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../life_of_a_request.html">Life of a Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment_types/deployment_types.html">Deployment types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_help.html">Getting help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../intro.html">Introduction</a></li>
          <li class="breadcrumb-item"><a href="../arch_overview.html">Architecture overview</a></li>
          <li class="breadcrumb-item"><a href="security.html">Security</a></li>
      <li class="breadcrumb-item active">External Authorization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/intro/arch_overview/security/ext_authz_filter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="external-authorization">
<span id="arch-overview-ext-authz"></span><h1>External Authorization<a class="headerlink" href="#external-authorization" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="../../../configuration/listeners/network_filters/ext_authz_filter.html#config-network-filters-ext-authz"><span class="std std-ref">Network filter configuration</span></a>.</p></li>
<li><p><a class="reference internal" href="../../../configuration/http/http_filters/ext_authz_filter.html#config-http-filters-ext-authz"><span class="std std-ref">HTTP filter configuration</span></a>.</p></li>
</ul>
<p>The External authorization filter calls an authorization service to check if the incoming request
is authorized or not. The filter can be either configured as a
<a class="reference internal" href="../../../configuration/listeners/network_filters/ext_authz_filter.html#config-network-filters-ext-authz"><span class="std std-ref">network filter</span></a>, or as a
<a class="reference internal" href="../../../configuration/http/http_filters/ext_authz_filter.html#config-http-filters-ext-authz"><span class="std std-ref">HTTP filter</span></a> or both. If the request is deemed
unauthorized by the network filter then the connection will be closed. If the request is deemed
unauthorized at the HTTP filter the request will be denied with 403 (Forbidden) response.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is recommended that these filters are configured as the first filter in the filter chain so
that requests are authorized prior to rest of the filters processing the request.</p>
</div>
<p>The external authorization service cluster may be either statically configured or configured via
the <a class="reference internal" href="../../../configuration/upstream/cluster_manager/cds.html#config-cluster-manager-cds"><span class="std std-ref">Cluster Discovery Service</span></a>. If the external service is not
available when a request comes in then whether the request is authorized or not is defined by the
configuration setting of <em>failure_mode_allow</em> configuration in the applicable
<a class="reference internal" href="../../../api-v3/extensions/filters/network/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-msg-extensions-filters-network-ext-authz-v3-extauthz"><span class="std std-ref">network filter</span></a> or
<a class="reference internal" href="../../../api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-msg-extensions-filters-http-ext-authz-v3-extauthz"><span class="std std-ref">HTTP filter</span></a>. If it is set to
true then the request will be permitted (fail open) otherwise it will be denied.
The default setting is <em>false</em>.</p>
<section id="service-definition">
<h2>Service Definition<a class="headerlink" href="#service-definition" title="Permalink to this heading"></a></h2>
<p>The context of the traffic is passed on to an external authorization service using the service
definition listed here.
The content of the request that are passed to an authorization service is specified by
<a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html#envoy-v3-api-msg-service-auth-v3-checkrequest"><span class="std std-ref">CheckRequest</span></a>.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api-v3/service/auth/v3/attribute_context.proto.html">Attribute Context  (proto)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/attribute_context.proto.html#service-auth-v3-attributecontext">service.auth.v3.AttributeContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/attribute_context.proto.html#service-auth-v3-attributecontext-peer">service.auth.v3.AttributeContext.Peer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/attribute_context.proto.html#service-auth-v3-attributecontext-request">service.auth.v3.AttributeContext.Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/attribute_context.proto.html#service-auth-v3-attributecontext-httprequest">service.auth.v3.AttributeContext.HttpRequest</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html">Authorization Service  (proto)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html#service-auth-v3-checkrequest">service.auth.v3.CheckRequest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html#service-auth-v3-deniedhttpresponse">service.auth.v3.DeniedHttpResponse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html#service-auth-v3-okhttpresponse">service.auth.v3.OkHttpResponse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api-v3/service/auth/v3/external_auth.proto.html#service-auth-v3-checkresponse">service.auth.v3.CheckResponse</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="jwt_authn_filter.html" class="btn btn-neutral float-left" title="JSON Web Token (JWT) Authentication" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../api-v3/service/auth/v3/attribute_context.proto.html" class="btn btn-neutral float-right" title="Attribute Context (proto)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2023, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>